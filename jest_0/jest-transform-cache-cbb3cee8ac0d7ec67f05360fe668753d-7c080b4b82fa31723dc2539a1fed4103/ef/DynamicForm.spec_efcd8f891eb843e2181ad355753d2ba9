f6d27c455cd241c848e4378e41331b26
'use strict';

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _semanticUiReact = require('semantic-ui-react');

var _enzyme = require('enzyme');

var _chance = require('chance');

var _DynamicForm = require('../../../src/components/helpers/DynamicForm');

var _DynamicForm2 = _interopRequireDefault(_DynamicForm);

var _InlineError = require('../../../src/components/helpers/InlineError');

var _InlineError2 = _interopRequireDefault(_InlineError);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var chance = new _chance.Chance();

var randomType = function randomType() {
  switch (chance.integer() % 4) {
    case 0:
      return 'textArea';
    case 1:
      return 'radio';
    case 2:
      return 'checkbox';
    case 3:
      return 'input';
    default:
      return 'textArea';
  }
};

var createRandomOptions = function createRandomOptions() {
  var options = [];
  var numberOfOptions = chance.integer() % 11 + 1;
  for (var counter = 0; counter < numberOfOptions; counter += 1) {
    options[counter] = chance.word();
  }
  return options;
};

var generateTestFormJson = function generateTestFormJson() {
  var name = chance.word();
  var jsonForm = {};
  var numberOfFields = chance.integer() % 11 + 1;
  var fields = [];
  for (var counter = 0; counter < numberOfFields; counter += 1) {
    var type = randomType();

    var field = {
      name: chance.word(),
      type: type,
      id: chance.word()
    };

    if (chance.integer() % 2 === 0) {
      field.validation = 'required';
    }
    if (type === 'radio') {
      field.options = createRandomOptions();
    }
    if (type === 'textArea' || type === 'input') {
      field.placeholder = chance.word();
    }

    fields[counter] = field;
  }
  jsonForm[name] = {};
  jsonForm[name].fields = fields;
  return jsonForm;
};

describe('DynamicForm', function () {
  var wrapper = void 0;
  var setRequest = jest.fn();
  var testJson = generateTestFormJson();
  var _route = jest.fn();
  var renderComponent = function renderComponent() {
    return (0, _enzyme.shallow)(_react2.default.createElement(_DynamicForm2.default, {
      jsonForm: function jsonForm() {
        return testJson;
      },
      setRequest: setRequest,
      form: Object.keys(testJson)[0],
      route: function route() {
        _route();
      }
    }));
  };

  beforeEach(function () {
    wrapper = renderComponent();
  });

  it('is wrapped in a Segment', function () {
    expect(wrapper.type()).toEqual(_semanticUiReact.Segment);
  });

  it('is styled as a padded Segment', function () {
    expect(wrapper.props().padded).toBeTruthy();
  });

  describe('header', function () {
    var header = void 0;

    beforeEach(function () {
      header = wrapper.childAt(0);
    });

    it('is a header', function () {
      expect(header.type()).toEqual(_semanticUiReact.Header);
    });

    it('is has a large size', function () {
      expect(header.props().size).toEqual('large');
    });

    it('is the correct text in the header', function () {
      expect(header.childAt(0).debug()).toEqual(Object.keys(testJson)[0]);
    });
  });

  describe('form', function () {
    it('is a form', function () {
      expect(wrapper.childAt(1).type()).toEqual(_semanticUiReact.Form);
    });

    describe('form data', function () {
      wrapper = renderComponent();
      console.log('The test');
      testJson[Object.keys(testJson)[0]].fields.forEach(function (field) {
        if (field.validation) {
          var fail = chance.integer() % 2;
          var count = 0;
          var form = wrapper.childAt(1);
          var segmentOfFields = form.childAt(0);
          it('field ' + count + ' is correct', function () {
            var label = segmentOfFields.childAt(count).childAt(0);
            if (field.validation) {
              expect(label.text()).toEqual(' * ' + field.name);
            } else {
              expect(label.text()).toEqual(field.name);
            }
            expect(wrapper.childAt(1).childAt(0).childAt(count).childAt(1).props().name === field.name);
            if (field.type === 'checkbox') {
              expect(wrapper.childAt(1).childAt(0).childAt(count).childAt(1).type()).toEqual(_semanticUiReact.Checkbox);
            }
            if (field.type === 'radio') {
              expect(wrapper.childAt(1).childAt(0).childAt(count).childAt(1).type()).toEqual(_semanticUiReact.Radio);

              if (fail) {
                var state = { errors: {} };
                state.errors[field.id] = 'Radio Button Not Selected';
                wrapper.setState(state);
                wrapper.update();
              }
            }
            if (field.type === 'textArea') {
              expect(wrapper.childAt(1).childAt(0).childAt(count).childAt(1).type()).toEqual(_semanticUiReact.TextArea);

              if (fail) {
                var _state = { errors: {} };
                _state.errors[field.id] = 'Empty Text Box';
                wrapper.setState(_state);
                wrapper.update();
                console.log(wrapper.childAt(1).childAt(0).childAt(count).find(_InlineError2.default).debug());
              }
            }
            if (field.type === 'dropDown') {
              expect(wrapper.childAt(1).childAt(0).childAt(count).childAt(1).type()).toEqual(_semanticUiReact.Dropdown);

              if (fail) {
                var _state2 = { errors: {} };
                _state2.errors[field.id] = 'Nothing is Selected';
                wrapper.setState(_state2);
                wrapper.update();
              }
            }
            if (field.type === 'input') {
              expect(wrapper.childAt(1).childAt(0).childAt(count).childAt(1).type()).toEqual(_semanticUiReact.Input);

              if (fail) {
                var _state3 = { errors: {} };
                _state3.errors[field.id] = 'Empty Input';
                wrapper.setState(_state3);
                wrapper.update();
              }
            }
            count += 1;
          });
        }
      });
    });
  });

  describe('Submit Button', function () {
    var submitSegment = void 0;

    beforeEach(function () {
      submitSegment = wrapper.childAt(1).childAt(1);
    });

    it('It is a segment', function () {
      expect(submitSegment.type()).toEqual(_semanticUiReact.Segment);
    });

    it('There is a button in the segment', function () {
      var button = submitSegment.childAt(0);
      expect(button.type()).toEqual(_semanticUiReact.Button);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkR5bmFtaWNGb3JtLnNwZWMuanMiXSwibmFtZXMiOlsiY2hhbmNlIiwiQ2hhbmNlIiwicmFuZG9tVHlwZSIsImludGVnZXIiLCJjcmVhdGVSYW5kb21PcHRpb25zIiwib3B0aW9ucyIsIm51bWJlck9mT3B0aW9ucyIsImNvdW50ZXIiLCJ3b3JkIiwiZ2VuZXJhdGVUZXN0Rm9ybUpzb24iLCJuYW1lIiwianNvbkZvcm0iLCJudW1iZXJPZkZpZWxkcyIsImZpZWxkcyIsInR5cGUiLCJmaWVsZCIsImlkIiwidmFsaWRhdGlvbiIsInBsYWNlaG9sZGVyIiwiZGVzY3JpYmUiLCJ3cmFwcGVyIiwic2V0UmVxdWVzdCIsImplc3QiLCJmbiIsInRlc3RKc29uIiwicm91dGUiLCJyZW5kZXJDb21wb25lbnQiLCJPYmplY3QiLCJrZXlzIiwiYmVmb3JlRWFjaCIsIml0IiwiZXhwZWN0IiwidG9FcXVhbCIsIlNlZ21lbnQiLCJwcm9wcyIsInBhZGRlZCIsInRvQmVUcnV0aHkiLCJoZWFkZXIiLCJjaGlsZEF0IiwiSGVhZGVyIiwic2l6ZSIsImRlYnVnIiwiRm9ybSIsImNvbnNvbGUiLCJsb2ciLCJmb3JFYWNoIiwiZmFpbCIsImNvdW50IiwiZm9ybSIsInNlZ21lbnRPZkZpZWxkcyIsImxhYmVsIiwidGV4dCIsIkNoZWNrYm94IiwiUmFkaW8iLCJzdGF0ZSIsImVycm9ycyIsInNldFN0YXRlIiwidXBkYXRlIiwiVGV4dEFyZWEiLCJmaW5kIiwiSW5saW5lRXJyb3JDb21wb25lbnQiLCJEcm9wZG93biIsIklucHV0Iiwic3VibWl0U2VnbWVudCIsImJ1dHRvbiIsIkJ1dHRvbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7OztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBQ0E7Ozs7OztBQUVBLElBQU1BLFNBQVMsSUFBSUMsY0FBSixFQUFmOztBQUVBLElBQU1DLGFBQWEsU0FBYkEsVUFBYSxHQUFNO0FBQ3ZCLFVBQVFGLE9BQU9HLE9BQVAsS0FBbUIsQ0FBM0I7QUFDRSxT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aUMsT0FBT2xELElBQVAsRUFBUCxFQUFzQmtCLE9BQXRCLENBQThCaUMsdUJBQTlCO0FBQ0QsS0FIRDtBQUlELEdBZkQ7QUFnQkQsQ0FqSkQiLCJmaWxlIjoiRHluYW1pY0Zvcm0uc3BlYy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBCdXR0b24sIEZvcm0sIFNlZ21lbnQsIEhlYWRlciwgUmFkaW8sIENoZWNrYm94LCBUZXh0QXJlYSwgRHJvcGRvd24sIElucHV0IH0gZnJvbSAnc2VtYW50aWMtdWktcmVhY3QnO1xuaW1wb3J0IHsgc2hhbGxvdyB9IGZyb20gJ2VuenltZSc7XG5pbXBvcnQgeyBDaGFuY2UgfSBmcm9tICdjaGFuY2UnO1xuaW1wb3J0IER5bmFtaWNGb3JtQ29tcG9uZW50IGZyb20gJy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL2hlbHBlcnMvRHluYW1pY0Zvcm0nO1xuaW1wb3J0IElubGluZUVycm9yQ29tcG9uZW50IGZyb20gJy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL2hlbHBlcnMvSW5saW5lRXJyb3InO1xuXG5jb25zdCBjaGFuY2UgPSBuZXcgQ2hhbmNlKCk7XG5cbmNvbnN0IHJhbmRvbVR5cGUgPSAoKSA9PiB7XG4gIHN3aXRjaCAoY2hhbmNlLmludGVnZXIoKSAlIDQpIHtcbiAgICBjYXNlIDA6XG4gICAgICByZXR1cm4gJ3RleHRBcmVhJztcbiAgICBjYXNlIDE6XG4gICAgICByZXR1cm4gJ3JhZGlvJztcbiAgICBjYXNlIDI6XG4gICAgICByZXR1cm4gJ2NoZWNrYm94JztcbiAgICBjYXNlIDM6XG4gICAgICByZXR1cm4gJ2lucHV0JztcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuICd0ZXh0QXJlYSc7XG4gIH1cbn07XG5cbmNvbnN0IGNyZWF0ZVJhbmRvbU9wdGlvbnMgPSAoKSA9PiB7XG4gIGNvbnN0IG9wdGlvbnMgPSBbXTtcbiAgY29uc3QgbnVtYmVyT2ZPcHRpb25zID0gKGNoYW5jZS5pbnRlZ2VyKCkgJSAxMSkgKyAxO1xuICBmb3IgKGxldCBjb3VudGVyID0gMDsgY291bnRlciA8IG51bWJlck9mT3B0aW9uczsgY291bnRlciArPSAxKSB7XG4gICAgb3B0aW9uc1tjb3VudGVyXSA9IGNoYW5jZS53b3JkKCk7XG4gIH1cbiAgcmV0dXJuIG9wdGlvbnM7XG59O1xuXG5jb25zdCBnZW5lcmF0ZVRlc3RGb3JtSnNvbiA9ICgpID0+IHtcbiAgY29uc3QgbmFtZSA9IGNoYW5jZS53b3JkKCk7XG4gIGNvbnN0IGpzb25Gb3JtID0ge307XG4gIGNvbnN0IG51bWJlck9mRmllbGRzID0gKGNoYW5jZS5pbnRlZ2VyKCkgJSAxMSkgKyAxO1xuICBjb25zdCBmaWVsZHMgPSBbXTtcbiAgZm9yIChsZXQgY291bnRlciA9IDA7IGNvdW50ZXIgPCBudW1iZXJPZkZpZWxkczsgY291bnRlciArPSAxKSB7XG4gICAgY29uc3QgdHlwZSA9IHJhbmRvbVR5cGUoKTtcblxuICAgIGNvbnN0IGZpZWxkID0ge1xuICAgICAgbmFtZTogY2hhbmNlLndvcmQoKSxcbiAgICAgIHR5cGUsXG4gICAgICBpZDogY2hhbmNlLndvcmQoKSxcbiAgICB9O1xuXG4gICAgaWYgKGNoYW5jZS5pbnRlZ2VyKCkgJSAyID09PSAwKSB7XG4gICAgICBmaWVsZC52YWxpZGF0aW9uID0gJ3JlcXVpcmVkJztcbiAgICB9XG4gICAgaWYgKHR5cGUgPT09ICdyYWRpbycpIHtcbiAgICAgIGZpZWxkLm9wdGlvbnMgPSBjcmVhdGVSYW5kb21PcHRpb25zKCk7XG4gICAgfVxuICAgIGlmICh0eXBlID09PSAndGV4dEFyZWEnIHx8IHR5cGUgPT09ICdpbnB1dCcpIHtcbiAgICAgIGZpZWxkLnBsYWNlaG9sZGVyID0gY2hhbmNlLndvcmQoKTtcbiAgICB9XG5cbiAgICBmaWVsZHNbY291bnRlcl0gPSBmaWVsZDtcbiAgfVxuICBqc29uRm9ybVtuYW1lXSA9IHt9O1xuICBqc29uRm9ybVtuYW1lXS5maWVsZHMgPSBmaWVsZHM7XG4gIHJldHVybiBqc29uRm9ybTtcbn07XG5cbmRlc2NyaWJlKCdEeW5hbWljRm9ybScsICgpID0+IHtcbiAgbGV0IHdyYXBwZXI7XG4gIGNvbnN0IHNldFJlcXVlc3QgPSBqZXN0LmZuKCk7XG4gIGNvbnN0IHRlc3RKc29uID0gZ2VuZXJhdGVUZXN0Rm9ybUpzb24oKTtcbiAgY29uc3Qgcm91dGUgPSBqZXN0LmZuKCk7XG4gIGNvbnN0IHJlbmRlckNvbXBvbmVudCA9ICgpID0+XG4gICAgc2hhbGxvdyhcbiAgICAgIDxEeW5hbWljRm9ybUNvbXBvbmVudFxuICAgICAgICBqc29uRm9ybT17KCkgPT4gdGVzdEpzb259XG4gICAgICAgIHNldFJlcXVlc3Q9e3NldFJlcXVlc3R9XG4gICAgICAgIGZvcm09e09iamVjdC5rZXlzKHRlc3RKc29uKVswXX1cbiAgICAgICAgcm91dGU9eygpID0+IHtcbiAgICAgICAgICByb3V0ZSgpO1xuICAgICAgICB9fVxuICAgICAgLz4sXG4gICAgKTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICB3cmFwcGVyID0gcmVuZGVyQ29tcG9uZW50KCk7XG4gIH0pO1xuXG4gIGl0KCdpcyB3cmFwcGVkIGluIGEgU2VnbWVudCcsICgpID0+IHtcbiAgICBleHBlY3Qod3JhcHBlci50eXBlKCkpLnRvRXF1YWwoU2VnbWVudCk7XG4gIH0pO1xuXG4gIGl0KCdpcyBzdHlsZWQgYXMgYSBwYWRkZWQgU2VnbWVudCcsICgpID0+IHtcbiAgICBleHBlY3Qod3JhcHBlci5wcm9wcygpLnBhZGRlZCkudG9CZVRydXRoeSgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnaGVhZGVyJywgKCkgPT4ge1xuICAgIGxldCBoZWFkZXI7XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIGhlYWRlciA9IHdyYXBwZXIuY2hpbGRBdCgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdpcyBhIGhlYWRlcicsICgpID0+IHtcbiAgICAgIGV4cGVjdChoZWFkZXIudHlwZSgpKS50b0VxdWFsKEhlYWRlcik7XG4gICAgfSk7XG5cbiAgICBpdCgnaXMgaGFzIGEgbGFyZ2Ugc2l6ZScsICgpID0+IHtcbiAgICAgIGV4cGVjdChoZWFkZXIucHJvcHMoKS5zaXplKS50b0VxdWFsKCdsYXJnZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2lzIHRoZSBjb3JyZWN0IHRleHQgaW4gdGhlIGhlYWRlcicsICgpID0+IHtcbiAgICAgIGV4cGVjdChoZWFkZXIuY2hpbGRBdCgwKS5kZWJ1ZygpKS50b0VxdWFsKE9iamVjdC5rZXlzKHRlc3RKc29uKVswXSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmb3JtJywgKCkgPT4ge1xuICAgIGl0KCdpcyBhIGZvcm0nLCAoKSA9PiB7XG4gICAgICBleHBlY3Qod3JhcHBlci5jaGlsZEF0KDEpLnR5cGUoKSkudG9FcXVhbChGb3JtKTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdmb3JtIGRhdGEnLCAoKSA9PiB7XG4gICAgICB3cmFwcGVyID0gcmVuZGVyQ29tcG9uZW50KCk7XG4gICAgICBjb25zb2xlLmxvZygnVGhlIHRlc3QnKTtcbiAgICAgIHRlc3RKc29uW09iamVjdC5rZXlzKHRlc3RKc29uKVswXV0uZmllbGRzLmZvckVhY2goKGZpZWxkKSA9PiB7XG4gICAgICAgIGlmIChmaWVsZC52YWxpZGF0aW9uKSB7XG4gICAgICAgICAgY29uc3QgZmFpbCA9IGNoYW5jZS5pbnRlZ2VyKCkgJSAyO1xuICAgICAgICAgIGxldCBjb3VudCA9IDA7XG4gICAgICAgICAgY29uc3QgZm9ybSA9IHdyYXBwZXIuY2hpbGRBdCgxKTtcbiAgICAgICAgICBjb25zdCBzZWdtZW50T2ZGaWVsZHMgPSBmb3JtLmNoaWxkQXQoMCk7XG4gICAgICAgICAgaXQoYGZpZWxkICR7Y291bnR9IGlzIGNvcnJlY3RgLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBsYWJlbCA9IHNlZ21lbnRPZkZpZWxkcy5jaGlsZEF0KGNvdW50KS5jaGlsZEF0KDApO1xuICAgICAgICAgICAgaWYgKGZpZWxkLnZhbGlkYXRpb24pIHtcbiAgICAgICAgICAgICAgZXhwZWN0KGxhYmVsLnRleHQoKSkudG9FcXVhbChgICogJHtmaWVsZC5uYW1lfWApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZXhwZWN0KGxhYmVsLnRleHQoKSkudG9FcXVhbChmaWVsZC5uYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV4cGVjdCh3cmFwcGVyLmNoaWxkQXQoMSkuY2hpbGRBdCgwKS5jaGlsZEF0KGNvdW50KS5jaGlsZEF0KDEpXG4gICAgICAgICAgICAgIC5wcm9wcygpLm5hbWUgPT09IGZpZWxkLm5hbWUpO1xuICAgICAgICAgICAgaWYgKGZpZWxkLnR5cGUgPT09ICdjaGVja2JveCcpIHtcbiAgICAgICAgICAgICAgZXhwZWN0KHdyYXBwZXIuY2hpbGRBdCgxKS5jaGlsZEF0KDApLmNoaWxkQXQoY291bnQpLmNoaWxkQXQoMSlcbiAgICAgICAgICAgICAgICAudHlwZSgpKS50b0VxdWFsKENoZWNrYm94KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmaWVsZC50eXBlID09PSAncmFkaW8nKSB7XG4gICAgICAgICAgICAgIGV4cGVjdCh3cmFwcGVyLmNoaWxkQXQoMSkuY2hpbGRBdCgwKS5jaGlsZEF0KGNvdW50KS5jaGlsZEF0KDEpXG4gICAgICAgICAgICAgICAgLnR5cGUoKSkudG9FcXVhbChSYWRpbyk7XG5cbiAgICAgICAgICAgICAgaWYgKGZhaWwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdGF0ZSA9IHsgZXJyb3JzOiB7fSB9O1xuICAgICAgICAgICAgICAgIHN0YXRlLmVycm9yc1tmaWVsZC5pZF0gPSAnUmFkaW8gQnV0dG9uIE5vdCBTZWxlY3RlZCc7XG4gICAgICAgICAgICAgICAgd3JhcHBlci5zZXRTdGF0ZShzdGF0ZSk7XG4gICAgICAgICAgICAgICAgd3JhcHBlci51cGRhdGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZpZWxkLnR5cGUgPT09ICd0ZXh0QXJlYScpIHtcbiAgICAgICAgICAgICAgZXhwZWN0KHdyYXBwZXIuY2hpbGRBdCgxKS5jaGlsZEF0KDApLmNoaWxkQXQoY291bnQpLmNoaWxkQXQoMSlcbiAgICAgICAgICAgICAgICAudHlwZSgpKS50b0VxdWFsKFRleHRBcmVhKTtcblxuICAgICAgICAgICAgICBpZiAoZmFpbCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXRlID0geyBlcnJvcnM6IHt9IH07XG4gICAgICAgICAgICAgICAgc3RhdGUuZXJyb3JzW2ZpZWxkLmlkXSA9ICdFbXB0eSBUZXh0IEJveCc7XG4gICAgICAgICAgICAgICAgd3JhcHBlci5zZXRTdGF0ZShzdGF0ZSk7XG4gICAgICAgICAgICAgICAgd3JhcHBlci51cGRhdGUoKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh3cmFwcGVyLmNoaWxkQXQoMSkuY2hpbGRBdCgwKS5jaGlsZEF0KGNvdW50KS5maW5kKElubGluZUVycm9yQ29tcG9uZW50KVxuICAgICAgICAgICAgICAgICAgLmRlYnVnKCkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmllbGQudHlwZSA9PT0gJ2Ryb3BEb3duJykge1xuICAgICAgICAgICAgICBleHBlY3Qod3JhcHBlci5jaGlsZEF0KDEpLmNoaWxkQXQoMCkuY2hpbGRBdChjb3VudCkuY2hpbGRBdCgxKVxuICAgICAgICAgICAgICAgIC50eXBlKCkpLnRvRXF1YWwoRHJvcGRvd24pO1xuXG4gICAgICAgICAgICAgIGlmIChmYWlsKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhdGUgPSB7IGVycm9yczoge30gfTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5lcnJvcnNbZmllbGQuaWRdID0gJ05vdGhpbmcgaXMgU2VsZWN0ZWQnO1xuICAgICAgICAgICAgICAgIHdyYXBwZXIuc2V0U3RhdGUoc3RhdGUpO1xuICAgICAgICAgICAgICAgIHdyYXBwZXIudXBkYXRlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmaWVsZC50eXBlID09PSAnaW5wdXQnKSB7XG4gICAgICAgICAgICAgIGV4cGVjdCh3cmFwcGVyLmNoaWxkQXQoMSkuY2hpbGRBdCgwKS5jaGlsZEF0KGNvdW50KS5jaGlsZEF0KDEpXG4gICAgICAgICAgICAgICAgLnR5cGUoKSkudG9FcXVhbChJbnB1dCk7XG5cbiAgICAgICAgICAgICAgaWYgKGZhaWwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdGF0ZSA9IHsgZXJyb3JzOiB7fSB9O1xuICAgICAgICAgICAgICAgIHN0YXRlLmVycm9yc1tmaWVsZC5pZF0gPSAnRW1wdHkgSW5wdXQnO1xuICAgICAgICAgICAgICAgIHdyYXBwZXIuc2V0U3RhdGUoc3RhdGUpO1xuICAgICAgICAgICAgICAgIHdyYXBwZXIudXBkYXRlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvdW50ICs9IDE7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU3VibWl0IEJ1dHRvbicsICgpID0+IHtcbiAgICBsZXQgc3VibWl0U2VnbWVudDtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgc3VibWl0U2VnbWVudCA9IHdyYXBwZXIuY2hpbGRBdCgxKS5jaGlsZEF0KDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ0l0IGlzIGEgc2VnbWVudCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChzdWJtaXRTZWdtZW50LnR5cGUoKSkudG9FcXVhbChTZWdtZW50KTtcbiAgICB9KTtcblxuICAgIGl0KCdUaGVyZSBpcyBhIGJ1dHRvbiBpbiB0aGUgc2VnbWVudCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGJ1dHRvbiA9IHN1Ym1pdFNlZ21lbnQuY2hpbGRBdCgwKTtcbiAgICAgIGV4cGVjdChidXR0b24udHlwZSgpKS50b0VxdWFsKEJ1dHRvbik7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXX0=