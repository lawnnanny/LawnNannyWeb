a848d988cab3a0cdc0f5dea11f9e0b99
'use strict';

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _semanticUiReact = require('semantic-ui-react');

var _enzyme = require('enzyme');

var _chance = require('chance');

var _DynamicForm = require('../../../src/components/helpers/DynamicForm');

var _DynamicForm2 = _interopRequireDefault(_DynamicForm);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var chance = new _chance.Chance();

var randomType = function randomType() {
  switch (chance.integer() % 4) {
    case 0:
      return 'textArea';
    case 1:
      return 'radio';
    case 2:
      return 'checkbox';
    case 3:
      return 'input';
    default:
      return 'textArea';
  }
};

var createRandomOptions = function createRandomOptions() {
  var options = [];
  var numberOfOptions = chance.integer();
  console.log(numberOfOptions + 'cats');
  for (var counter = 0; counter < numberOfOptions; counter += 1) {
    options[counter] = chance.string();
  }
  return options;
};

var generateTestFormJson = function generateTestFormJson() {
  var name = chance.string();
  var jsonForm = {};
  var numberOfFields = chance.integer();
  var fields = [];
  for (var counter = 0; counter < numberOfFields; counter += 1) {
    var type = randomType();

    var field = {
      name: chance.string(),
      type: type,
      id: chance.string()
    };

    if (chance.integer() % 2 === 0) {
      field.validation = 'required';
    }
    if (type === 'radio') {
      field.options = createRandomOptions();
    }
    if (type === 'textArea' || type === 'input') {
      field.placeholder = chance.string();
    }

    fields[counter] = field;
  }
  jsonForm[name] = fields;
  return jsonForm;
};

describe('DynamicForm', function () {
  var wrapper = void 0;
  var setRequest = jest.fn();
  var testJson = generateTestFormJson();
  var _route = jest.fn();
  var renderComponent = function renderComponent() {
    return (0, _enzyme.shallow)(_react2.default.createElement(_DynamicForm2.default, {
      jsonForm: function jsonForm() {
        return testJson;
      },
      setRequest: setRequest,
      form: Object.values(testJson)[0],
      route: function route() {
        _route();
      }
    }));
  };

  beforeEach(function () {
    wrapper = renderComponent();
  });

  it('is wrapped in a Segment', function () {
    expect(wrapper.type()).toEqual(_semanticUiReact.Segment);
  });

  it('is styled as a padded Segment', function () {
    expect(wrapper.props().padded).toBeTruthy();
  });

  describe('header', function () {
    var header = void 0;

    beforeEach(function () {
      header = wrapper.childAt(0);
    });

    it('is a header', function () {
      expect(header.type()).toEqual(_semanticUiReact.Header);
    });

    it('is has a large size', function () {
      expect(header.props().size).toEqual('large');
    });

    it('is the correct text in the header', function () {
      expect(header.text()).to.equal(Object.values(testJson)[0]);
    });
  });

  describe('form', function () {
    var form = void 0;
    var segmentOfFields = void 0;

    beforeEach(function () {
      form = wrapper.childAt(1);
      segmentOfFields = form.childAt(0);
    });

    it('is a form', function () {
      expect(form.type()).toEqual(_semanticUiReact.Form);
    });

    describe('form data', function () {
      var counter = 0;
      testJson[0].forEach(function (field) {
        var jsxField = segmentOfFields.childAt(counter);
        it('field ' + counter + ' is correct', function () {
          var label = jsxField.childAt(0);
          if (field.validation) {
            expect(label.text()).to.equal('*' + field.name);
          } else {
            expect(label.text()).to.equal(field.name);
          }
          expect(jsxField.childAt(1).props().name === field.name);
          if (field.type === 'checkbox') {
            expect(jsxField.childAt(1).type()).toEqual(_semanticUiReact.Checkbox);
          }
          if (field.type === 'radio') {
            expect(jsxField.childAt(1).type()).toEqual(_semanticUiReact.Radio);
          }
          if (field.type === 'textArea') {
            expect(jsxField.childAt(1).type()).toEqual(_semanticUiReact.TextArea);
          }
          if (field.type === 'dropDown') {
            expect(jsxField.childAt(1).type()).toEqual(_semanticUiReact.Dropdown);
          }
          if (field.type === 'input') {
            expect(jsxField.childAt(1).type()).toEqual(_semanticUiReact.Input);
          }
        });
      });
    });
  });

  describe('Submit Button', function () {
    var submitSegment = void 0;

    beforeEach(function () {
      submitSegment = wrapper.childAt(1).childAt(1);
    });

    it('It is a segment', function () {
      expect(submitSegment.type()).toEqual(_semanticUiReact.Segment);
    });

    it('There is a button in the segment', function () {
      var button = submitSegment.childAt(0);
      expect(button.type()).toEqual(_semanticUiReact.Button);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkR5bmFtaWNGb3JtLnNwZWMuanMiXSwibmFtZXMiOlsiY2hhbmNlIiwiQ2hhbmNlIiwicmFuZG9tVHlwZSIsImludGVnZXIiLCJjcmVhdGVSYW5kb21PcHRpb25zIiwib3B0aW9ucyIsIm51bWJlck9mT3B0aW9ucyIsImNvbnNvbGUiLCJsb2ciLCJjb3VudGVyIiwic3RyaW5nIiwiZ2VuZXJhdGVUZXN0Rm9ybUpzb24iLCJuYW1lIiwianNvbkZvcm0iLCJudW1iZXJPZkZpZWxkcyIsImZpZWxkcyIsInR5cGUiLCJmaWVsZCIsImlkIiwidmFsaWRhdGlvbiIsInBsYWNlaG9sZGVyIiwiZGVzY3JpYmUiLCJ3cmFwcGVyIiwic2V0UmVxdWVzdCIsImplc3QiLCJmbiIsInRlc3RKc29uIiwicm91dGUiLCJyZW5kZXJDb21wb25lbnQiLCJPYmplY3QiLCJ2YWx1ZXMiLCJiZWZvcmVFYWNoIiwiaXQiLCJleHBlY3QiLCJ0b0VxdWFsIiwiU2VnbWVudCIsInByb3BzIiwicGFkZGVkIiwidG9CZVRydXRoeSIsImhlYWRlciIsImNoaWxkQXQiLCJIZWFkZXIiLCJzaXplIiwidGV4dCIsInRvIiwiZXF1YWwiLCJmb3JtIiwic2VnbWVudE9mRmllbGRzIiwiRm9ybSIsImZvckVhY2giLCJqc3hGaWVsZCIsImxhYmVsIiwiQ2hlY2tib3giLCJSYWRpbyIsIlRleHRBcmVhIiwiRHJvcGRvd24iLCJJbnB1dCIsInN1Ym1pdFNlZ21lbnQiLCJidXR0b24iLCJCdXR0b24iXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7O0FBRUEsSUFBTUEsU0FBUyxJQUFJQyxjQUFKLEVBQWY7O0FBRUEsSUFBTUMsYUFBYSxTQUFiQSxVQUFhLEdBQU07QUFDdkIsVUFBUUYsT0FBT0csT0FBUCxLQUFtQixDQUEzQjtBQUNFLFNBQUssQ0FBTDtBQUNFLGFBQU8sVUFBUDtBQUNGLFNBQUssQ0FBTDtBQUNFLGFBQU8sT0FBUDtBQUNGLFNBQUssQ0FBTDtB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TTtBQUM5QixRQUFJb0Msc0JBQUo7O0FBRUExQixlQUFXLFlBQU07QUFDZjBCLHNCQUFnQm5DLFFBQVFrQixPQUFSLENBQWdCLENBQWhCLEVBQW1CQSxPQUFuQixDQUEyQixDQUEzQixDQUFoQjtBQUNELEtBRkQ7O0FBSUFSLE9BQUcsaUJBQUgsRUFBc0IsWUFBTTtBQUMxQkMsYUFBT3dCLGNBQWN6QyxJQUFkLEVBQVAsRUFBNkJrQixPQUE3QixDQUFxQ0Msd0JBQXJDO0FBQ0QsS0FGRDs7QUFJQUgsT0FBRyxrQ0FBSCxFQUF1QyxZQUFNO0FBQzNDLFVBQU0wQixTQUFTRCxjQUFjakIsT0FBZCxDQUFzQixDQUF0QixDQUFmO0FBQ0FQLGFBQU95QixPQUFPMUMsSUFBUCxFQUFQLEVBQXNCa0IsT0FBdEIsQ0FBOEJ5Qix1QkFBOUI7QUFDRCxLQUhEO0FBSUQsR0FmRDtBQWdCRCxDQTlHRCIsImZpbGUiOiJEeW5hbWljRm9ybS5zcGVjLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEJ1dHRvbiwgRm9ybSwgU2VnbWVudCwgSGVhZGVyLCBSYWRpbywgQ2hlY2tib3gsIFRleHRBcmVhLCBEcm9wZG93biwgSW5wdXQgfSBmcm9tICdzZW1hbnRpYy11aS1yZWFjdCc7XG5pbXBvcnQgeyBzaGFsbG93IH0gZnJvbSAnZW56eW1lJztcbmltcG9ydCB7IENoYW5jZSB9IGZyb20gJ2NoYW5jZSc7XG5pbXBvcnQgRHluYW1pY0Zvcm1Db21wb25lbnQgZnJvbSAnLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvaGVscGVycy9EeW5hbWljRm9ybSc7XG5cbmNvbnN0IGNoYW5jZSA9IG5ldyBDaGFuY2UoKTtcblxuY29uc3QgcmFuZG9tVHlwZSA9ICgpID0+IHtcbiAgc3dpdGNoIChjaGFuY2UuaW50ZWdlcigpICUgNCkge1xuICAgIGNhc2UgMDpcbiAgICAgIHJldHVybiAndGV4dEFyZWEnO1xuICAgIGNhc2UgMTpcbiAgICAgIHJldHVybiAncmFkaW8nO1xuICAgIGNhc2UgMjpcbiAgICAgIHJldHVybiAnY2hlY2tib3gnO1xuICAgIGNhc2UgMzpcbiAgICAgIHJldHVybiAnaW5wdXQnO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gJ3RleHRBcmVhJztcbiAgfVxufTtcblxuY29uc3QgY3JlYXRlUmFuZG9tT3B0aW9ucyA9ICgpID0+IHtcbiAgY29uc3Qgb3B0aW9ucyA9IFtdO1xuICBjb25zdCBudW1iZXJPZk9wdGlvbnMgPSBjaGFuY2UuaW50ZWdlcigpO1xuICBjb25zb2xlLmxvZyhgJHtudW1iZXJPZk9wdGlvbnN9Y2F0c2ApO1xuICBmb3IgKGxldCBjb3VudGVyID0gMDsgY291bnRlciA8IG51bWJlck9mT3B0aW9uczsgY291bnRlciArPSAxKSB7XG4gICAgb3B0aW9uc1tjb3VudGVyXSA9IGNoYW5jZS5zdHJpbmcoKTtcbiAgfVxuICByZXR1cm4gb3B0aW9ucztcbn07XG5cbmNvbnN0IGdlbmVyYXRlVGVzdEZvcm1Kc29uID0gKCkgPT4ge1xuICBjb25zdCBuYW1lID0gY2hhbmNlLnN0cmluZygpO1xuICBjb25zdCBqc29uRm9ybSA9IHt9O1xuICBjb25zdCBudW1iZXJPZkZpZWxkcyA9IGNoYW5jZS5pbnRlZ2VyKCk7XG4gIGNvbnN0IGZpZWxkcyA9IFtdO1xuICBmb3IgKGxldCBjb3VudGVyID0gMDsgY291bnRlciA8IG51bWJlck9mRmllbGRzOyBjb3VudGVyICs9IDEpIHtcbiAgICBjb25zdCB0eXBlID0gcmFuZG9tVHlwZSgpO1xuXG4gICAgY29uc3QgZmllbGQgPSB7XG4gICAgICBuYW1lOiBjaGFuY2Uuc3RyaW5nKCksXG4gICAgICB0eXBlLFxuICAgICAgaWQ6IGNoYW5jZS5zdHJpbmcoKSxcbiAgICB9O1xuXG4gICAgaWYgKGNoYW5jZS5pbnRlZ2VyKCkgJSAyID09PSAwKSB7XG4gICAgICBmaWVsZC52YWxpZGF0aW9uID0gJ3JlcXVpcmVkJztcbiAgICB9XG4gICAgaWYgKHR5cGUgPT09ICdyYWRpbycpIHtcbiAgICAgIGZpZWxkLm9wdGlvbnMgPSBjcmVhdGVSYW5kb21PcHRpb25zKCk7XG4gICAgfVxuICAgIGlmICh0eXBlID09PSAndGV4dEFyZWEnIHx8IHR5cGUgPT09ICdpbnB1dCcpIHtcbiAgICAgIGZpZWxkLnBsYWNlaG9sZGVyID0gY2hhbmNlLnN0cmluZygpO1xuICAgIH1cblxuICAgIGZpZWxkc1tjb3VudGVyXSA9IGZpZWxkO1xuICB9XG4gIGpzb25Gb3JtW25hbWVdID0gZmllbGRzO1xuICByZXR1cm4ganNvbkZvcm07XG59O1xuXG5kZXNjcmliZSgnRHluYW1pY0Zvcm0nLCAoKSA9PiB7XG4gIGxldCB3cmFwcGVyO1xuICBjb25zdCBzZXRSZXF1ZXN0ID0gamVzdC5mbigpO1xuICBjb25zdCB0ZXN0SnNvbiA9IGdlbmVyYXRlVGVzdEZvcm1Kc29uKCk7XG4gIGNvbnN0IHJvdXRlID0gamVzdC5mbigpO1xuICBjb25zdCByZW5kZXJDb21wb25lbnQgPSAoKSA9PlxuICAgIHNoYWxsb3coXG4gICAgICA8RHluYW1pY0Zvcm1Db21wb25lbnRcbiAgICAgICAganNvbkZvcm09eygpID0+IHRlc3RKc29ufVxuICAgICAgICBzZXRSZXF1ZXN0PXtzZXRSZXF1ZXN0fVxuICAgICAgICBmb3JtPXtPYmplY3QudmFsdWVzKHRlc3RKc29uKVswXX1cbiAgICAgICAgcm91dGU9eygpID0+IHtcbiAgICAgICAgICByb3V0ZSgpO1xuICAgICAgICB9fVxuICAgICAgLz4sXG4gICAgKTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICB3cmFwcGVyID0gcmVuZGVyQ29tcG9uZW50KCk7XG4gIH0pO1xuXG4gIGl0KCdpcyB3cmFwcGVkIGluIGEgU2VnbWVudCcsICgpID0+IHtcbiAgICBleHBlY3Qod3JhcHBlci50eXBlKCkpLnRvRXF1YWwoU2VnbWVudCk7XG4gIH0pO1xuXG4gIGl0KCdpcyBzdHlsZWQgYXMgYSBwYWRkZWQgU2VnbWVudCcsICgpID0+IHtcbiAgICBleHBlY3Qod3JhcHBlci5wcm9wcygpLnBhZGRlZCkudG9CZVRydXRoeSgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnaGVhZGVyJywgKCkgPT4ge1xuICAgIGxldCBoZWFkZXI7XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIGhlYWRlciA9IHdyYXBwZXIuY2hpbGRBdCgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdpcyBhIGhlYWRlcicsICgpID0+IHtcbiAgICAgIGV4cGVjdChoZWFkZXIudHlwZSgpKS50b0VxdWFsKEhlYWRlcik7XG4gICAgfSk7XG5cbiAgICBpdCgnaXMgaGFzIGEgbGFyZ2Ugc2l6ZScsICgpID0+IHtcbiAgICAgIGV4cGVjdChoZWFkZXIucHJvcHMoKS5zaXplKS50b0VxdWFsKCdsYXJnZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2lzIHRoZSBjb3JyZWN0IHRleHQgaW4gdGhlIGhlYWRlcicsICgpID0+IHtcbiAgICAgIGV4cGVjdChoZWFkZXIudGV4dCgpKS50by5lcXVhbChPYmplY3QudmFsdWVzKHRlc3RKc29uKVswXSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmb3JtJywgKCkgPT4ge1xuICAgIGxldCBmb3JtO1xuICAgIGxldCBzZWdtZW50T2ZGaWVsZHM7XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIGZvcm0gPSB3cmFwcGVyLmNoaWxkQXQoMSk7XG4gICAgICBzZWdtZW50T2ZGaWVsZHMgPSBmb3JtLmNoaWxkQXQoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnaXMgYSBmb3JtJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGZvcm0udHlwZSgpKS50b0VxdWFsKEZvcm0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2Zvcm0gZGF0YScsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvdW50ZXIgPSAwO1xuICAgICAgdGVzdEpzb25bMF0uZm9yRWFjaCgoZmllbGQpID0+IHtcbiAgICAgICAgY29uc3QganN4RmllbGQgPSBzZWdtZW50T2ZGaWVsZHMuY2hpbGRBdChjb3VudGVyKTtcbiAgICAgICAgaXQoYGZpZWxkICR7Y291bnRlcn0gaXMgY29ycmVjdGAsICgpID0+IHtcbiAgICAgICAgICBjb25zdCBsYWJlbCA9IGpzeEZpZWxkLmNoaWxkQXQoMCk7XG4gICAgICAgICAgaWYgKGZpZWxkLnZhbGlkYXRpb24pIHtcbiAgICAgICAgICAgIGV4cGVjdChsYWJlbC50ZXh0KCkpLnRvLmVxdWFsKGAqJHtmaWVsZC5uYW1lfWApO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBleHBlY3QobGFiZWwudGV4dCgpKS50by5lcXVhbChmaWVsZC5uYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZXhwZWN0KGpzeEZpZWxkLmNoaWxkQXQoMSkucHJvcHMoKS5uYW1lID09PSBmaWVsZC5uYW1lKTtcbiAgICAgICAgICBpZiAoZmllbGQudHlwZSA9PT0gJ2NoZWNrYm94Jykge1xuICAgICAgICAgICAgZXhwZWN0KGpzeEZpZWxkLmNoaWxkQXQoMSkudHlwZSgpKS50b0VxdWFsKENoZWNrYm94KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGZpZWxkLnR5cGUgPT09ICdyYWRpbycpIHtcbiAgICAgICAgICAgIGV4cGVjdChqc3hGaWVsZC5jaGlsZEF0KDEpLnR5cGUoKSkudG9FcXVhbChSYWRpbyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChmaWVsZC50eXBlID09PSAndGV4dEFyZWEnKSB7XG4gICAgICAgICAgICBleHBlY3QoanN4RmllbGQuY2hpbGRBdCgxKS50eXBlKCkpLnRvRXF1YWwoVGV4dEFyZWEpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZmllbGQudHlwZSA9PT0gJ2Ryb3BEb3duJykge1xuICAgICAgICAgICAgZXhwZWN0KGpzeEZpZWxkLmNoaWxkQXQoMSkudHlwZSgpKS50b0VxdWFsKERyb3Bkb3duKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGZpZWxkLnR5cGUgPT09ICdpbnB1dCcpIHtcbiAgICAgICAgICAgIGV4cGVjdChqc3hGaWVsZC5jaGlsZEF0KDEpLnR5cGUoKSkudG9FcXVhbChJbnB1dCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU3VibWl0IEJ1dHRvbicsICgpID0+IHtcbiAgICBsZXQgc3VibWl0U2VnbWVudDtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgc3VibWl0U2VnbWVudCA9IHdyYXBwZXIuY2hpbGRBdCgxKS5jaGlsZEF0KDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ0l0IGlzIGEgc2VnbWVudCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChzdWJtaXRTZWdtZW50LnR5cGUoKSkudG9FcXVhbChTZWdtZW50KTtcbiAgICB9KTtcblxuICAgIGl0KCdUaGVyZSBpcyBhIGJ1dHRvbiBpbiB0aGUgc2VnbWVudCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGJ1dHRvbiA9IHN1Ym1pdFNlZ21lbnQuY2hpbGRBdCgwKTtcbiAgICAgIGV4cGVjdChidXR0b24udHlwZSgpKS50b0VxdWFsKEJ1dHRvbik7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXX0=