b85c05da554f722d3bd8f9f455290af6
'use strict';

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _semanticUiReact = require('semantic-ui-react');

var _enzyme = require('enzyme');

var _chance = require('chance');

var _DynamicForm = require('../../../src/components/helpers/DynamicForm');

var _DynamicForm2 = _interopRequireDefault(_DynamicForm);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var chance = new _chance.Chance();

var randomType = function randomType() {
  switch (chance.integer() % 4) {
    case 0:
      return 'textArea';
    case 1:
      return 'radio';
    case 2:
      return 'checkbox';
    case 3:
      return 'input';
    default:
      return 'textArea';
  }
};

var createRandomOptions = function createRandomOptions() {
  var options = [];
  var numberOfOptions = chance.integer() % 11 + 1;
  for (var counter = 0; counter < numberOfOptions; counter += 1) {
    options[counter] = chance.string();
  }
  return options;
};

var generateTestFormJson = function generateTestFormJson() {
  var name = chance.string();
  var jsonForm = {};
  var numberOfFields = chance.integer() % 11 + 1;
  var fields = [];
  for (var counter = 0; counter < numberOfFields; counter += 1) {
    var type = randomType();

    var field = {
      name: chance.string(),
      type: type,
      id: chance.string()
    };

    if (chance.integer() % 2 === 0) {
      field.validation = 'required';
    }
    if (type === 'radio') {
      field.options = createRandomOptions();
    }
    if (type === 'textArea' || type === 'input') {
      field.placeholder = chance.string();
    }

    fields[counter] = field;
  }
  jsonForm[name] = fields;
  return jsonForm;
};

describe('DynamicForm', function () {
  var wrapper = void 0;
  var setRequest = jest.fn();
  var testJson = generateTestFormJson();
  console.log(testJson);
  var _route = jest.fn();
  var renderComponent = function renderComponent() {
    return (0, _enzyme.shallow)(_react2.default.createElement(_DynamicForm2.default, {
      jsonForm: function jsonForm() {
        return testJson;
      },
      setRequest: setRequest,
      form: Object.keys(testJson)[0],
      route: function route() {
        _route();
      }
    }));
  };

  beforeEach(function () {
    wrapper = renderComponent();
  });

  it('is wrapped in a Segment', function () {
    expect(wrapper.type()).toEqual(_semanticUiReact.Segment);
  });

  it('is styled as a padded Segment', function () {
    expect(wrapper.props().padded).toBeTruthy();
  });

  describe('header', function () {
    var header = void 0;

    beforeEach(function () {
      header = wrapper.childAt(0);
    });

    it('is a header', function () {
      expect(header.type()).toEqual(_semanticUiReact.Header);
    });

    it('is has a large size', function () {
      expect(header.props().size).toEqual('large');
    });

    it('is the correct text in the header', function () {
      expect(header.text()).to.equal(Object.values(testJson)[0]);
    });
  });

  describe('form', function () {
    var form = void 0;
    var segmentOfFields = void 0;

    beforeEach(function () {
      form = wrapper.childAt(1);
      segmentOfFields = form.childAt(0);
    });

    it('is a form', function () {
      expect(form.type()).toEqual(_semanticUiReact.Form);
    });

    describe('form data', function () {
      var counter = 0;
      testJson[0].forEach(function (field) {
        var jsxField = segmentOfFields.childAt(counter);
        it('field ' + counter + ' is correct', function () {
          var label = jsxField.childAt(0);
          if (field.validation) {
            expect(label.text()).to.equal('*' + field.name);
          } else {
            expect(label.text()).to.equal(field.name);
          }
          expect(jsxField.childAt(1).props().name === field.name);
          if (field.type === 'checkbox') {
            expect(jsxField.childAt(1).type()).toEqual(_semanticUiReact.Checkbox);
          }
          if (field.type === 'radio') {
            expect(jsxField.childAt(1).type()).toEqual(_semanticUiReact.Radio);
          }
          if (field.type === 'textArea') {
            expect(jsxField.childAt(1).type()).toEqual(_semanticUiReact.TextArea);
          }
          if (field.type === 'dropDown') {
            expect(jsxField.childAt(1).type()).toEqual(_semanticUiReact.Dropdown);
          }
          if (field.type === 'input') {
            expect(jsxField.childAt(1).type()).toEqual(_semanticUiReact.Input);
          }
        });
      });
    });
  });

  describe('Submit Button', function () {
    var submitSegment = void 0;

    beforeEach(function () {
      submitSegment = wrapper.childAt(1).childAt(1);
    });

    it('It is a segment', function () {
      expect(submitSegment.type()).toEqual(_semanticUiReact.Segment);
    });

    it('There is a button in the segment', function () {
      var button = submitSegment.childAt(0);
      expect(button.type()).toEqual(_semanticUiReact.Button);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkR5bmFtaWNGb3JtLnNwZWMuanMiXSwibmFtZXMiOlsiY2hhbmNlIiwiQ2hhbmNlIiwicmFuZG9tVHlwZSIsImludGVnZXIiLCJjcmVhdGVSYW5kb21PcHRpb25zIiwib3B0aW9ucyIsIm51bWJlck9mT3B0aW9ucyIsImNvdW50ZXIiLCJzdHJpbmciLCJnZW5lcmF0ZVRlc3RGb3JtSnNvbiIsIm5hbWUiLCJqc29uRm9ybSIsIm51bWJlck9mRmllbGRzIiwiZmllbGRzIiwidHlwZSIsImZpZWxkIiwiaWQiLCJ2YWxpZGF0aW9uIiwicGxhY2Vob2xkZXIiLCJkZXNjcmliZSIsIndyYXBwZXIiLCJzZXRSZXF1ZXN0IiwiamVzdCIsImZuIiwidGVzdEpzb24iLCJjb25zb2xlIiwibG9nIiwicm91dGUiLCJyZW5kZXJDb21wb25lbnQiLCJPYmplY3QiLCJrZXlzIiwiYmVmb3JlRWFjaCIsIml0IiwiZXhwZWN0IiwidG9FcXVhbCIsIlNlZ21lbnQiLCJwcm9wcyIsInBhZGRlZCIsInRvQmVUcnV0aHkiLCJoZWFkZXIiLCJjaGlsZEF0IiwiSGVhZGVyIiwic2l6ZSIsInRleHQiLCJ0byIsImVxdWFsIiwidmFsdWVzIiwiZm9ybSIsInNlZ21lbnRPZkZpZWxkcyIsIkZvcm0iLCJmb3JFYWNoIiwianN4RmllbGQiLCJsYWJlbCIsIkNoZWNrYm94IiwiUmFkaW8iLCJUZXh0QXJlYSIsIkRyb3Bkb3duIiwiSW5wdXQiLCJzdWJtaXRTZWdtZW50IiwiYnV0dG9uIiwiQnV0dG9uIl0sIm1hcHBpbmdzIjoiOztBQUFBOzs7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7OztBQUVBLElBQU1BLFNBQVMsSUFBSUMsY0FBSixFQUFmOztBQUVBLElBQU1DLGFBQWEsU0FBYkEsVUFBYSxHQUFNO0FBQ3ZCLFVBQVFGLE9BQU9HLE9BQVAsS0FBbUIsQ0FBM0I7QUFDRSxTQUFLLENBQUw7QUFDRSxhQUFPLFVBQVA7QUFDRixTQUFLLENBQUw7QUFDRSxhQUFPLE9BQVA7QUFDRixTQUFL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RCxLQTdCRDtBQThCRCxHQTNDRDs7QUE2Q0F0QyxXQUFTLGVBQVQsRUFBMEIsWUFBTTtBQUM5QixRQUFJdUMsc0JBQUo7O0FBRUEzQixlQUFXLFlBQU07QUFDZjJCLHNCQUFnQnRDLFFBQVFvQixPQUFSLENBQWdCLENBQWhCLEVBQW1CQSxPQUFuQixDQUEyQixDQUEzQixDQUFoQjtBQUNELEtBRkQ7O0FBSUFSLE9BQUcsaUJBQUgsRUFBc0IsWUFBTTtBQUMxQkMsYUFBT3lCLGNBQWM1QyxJQUFkLEVBQVAsRUFBNkJvQixPQUE3QixDQUFxQ0Msd0JBQXJDO0FBQ0QsS0FGRDs7QUFJQUgsT0FBRyxrQ0FBSCxFQUF1QyxZQUFNO0FBQzNDLFVBQU0yQixTQUFTRCxjQUFjbEIsT0FBZCxDQUFzQixDQUF0QixDQUFmO0FBQ0FQLGFBQU8wQixPQUFPN0MsSUFBUCxFQUFQLEVBQXNCb0IsT0FBdEIsQ0FBOEIwQix1QkFBOUI7QUFDRCxLQUhEO0FBSUQsR0FmRDtBQWdCRCxDQS9HRCIsImZpbGUiOiJEeW5hbWljRm9ybS5zcGVjLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEJ1dHRvbiwgRm9ybSwgU2VnbWVudCwgSGVhZGVyLCBSYWRpbywgQ2hlY2tib3gsIFRleHRBcmVhLCBEcm9wZG93biwgSW5wdXQgfSBmcm9tICdzZW1hbnRpYy11aS1yZWFjdCc7XG5pbXBvcnQgeyBzaGFsbG93IH0gZnJvbSAnZW56eW1lJztcbmltcG9ydCB7IENoYW5jZSB9IGZyb20gJ2NoYW5jZSc7XG5pbXBvcnQgRHluYW1pY0Zvcm1Db21wb25lbnQgZnJvbSAnLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvaGVscGVycy9EeW5hbWljRm9ybSc7XG5cbmNvbnN0IGNoYW5jZSA9IG5ldyBDaGFuY2UoKTtcblxuY29uc3QgcmFuZG9tVHlwZSA9ICgpID0+IHtcbiAgc3dpdGNoIChjaGFuY2UuaW50ZWdlcigpICUgNCkge1xuICAgIGNhc2UgMDpcbiAgICAgIHJldHVybiAndGV4dEFyZWEnO1xuICAgIGNhc2UgMTpcbiAgICAgIHJldHVybiAncmFkaW8nO1xuICAgIGNhc2UgMjpcbiAgICAgIHJldHVybiAnY2hlY2tib3gnO1xuICAgIGNhc2UgMzpcbiAgICAgIHJldHVybiAnaW5wdXQnO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gJ3RleHRBcmVhJztcbiAgfVxufTtcblxuY29uc3QgY3JlYXRlUmFuZG9tT3B0aW9ucyA9ICgpID0+IHtcbiAgY29uc3Qgb3B0aW9ucyA9IFtdO1xuICBjb25zdCBudW1iZXJPZk9wdGlvbnMgPSAoY2hhbmNlLmludGVnZXIoKSAlIDExKSArIDE7XG4gIGZvciAobGV0IGNvdW50ZXIgPSAwOyBjb3VudGVyIDwgbnVtYmVyT2ZPcHRpb25zOyBjb3VudGVyICs9IDEpIHtcbiAgICBvcHRpb25zW2NvdW50ZXJdID0gY2hhbmNlLnN0cmluZygpO1xuICB9XG4gIHJldHVybiBvcHRpb25zO1xufTtcblxuY29uc3QgZ2VuZXJhdGVUZXN0Rm9ybUpzb24gPSAoKSA9PiB7XG4gIGNvbnN0IG5hbWUgPSBjaGFuY2Uuc3RyaW5nKCk7XG4gIGNvbnN0IGpzb25Gb3JtID0ge307XG4gIGNvbnN0IG51bWJlck9mRmllbGRzID0gKGNoYW5jZS5pbnRlZ2VyKCkgJSAxMSkgKyAxO1xuICBjb25zdCBmaWVsZHMgPSBbXTtcbiAgZm9yIChsZXQgY291bnRlciA9IDA7IGNvdW50ZXIgPCBudW1iZXJPZkZpZWxkczsgY291bnRlciArPSAxKSB7XG4gICAgY29uc3QgdHlwZSA9IHJhbmRvbVR5cGUoKTtcblxuICAgIGNvbnN0IGZpZWxkID0ge1xuICAgICAgbmFtZTogY2hhbmNlLnN0cmluZygpLFxuICAgICAgdHlwZSxcbiAgICAgIGlkOiBjaGFuY2Uuc3RyaW5nKCksXG4gICAgfTtcblxuICAgIGlmIChjaGFuY2UuaW50ZWdlcigpICUgMiA9PT0gMCkge1xuICAgICAgZmllbGQudmFsaWRhdGlvbiA9ICdyZXF1aXJlZCc7XG4gICAgfVxuICAgIGlmICh0eXBlID09PSAncmFkaW8nKSB7XG4gICAgICBmaWVsZC5vcHRpb25zID0gY3JlYXRlUmFuZG9tT3B0aW9ucygpO1xuICAgIH1cbiAgICBpZiAodHlwZSA9PT0gJ3RleHRBcmVhJyB8fCB0eXBlID09PSAnaW5wdXQnKSB7XG4gICAgICBmaWVsZC5wbGFjZWhvbGRlciA9IGNoYW5jZS5zdHJpbmcoKTtcbiAgICB9XG5cbiAgICBmaWVsZHNbY291bnRlcl0gPSBmaWVsZDtcbiAgfVxuICBqc29uRm9ybVtuYW1lXSA9IGZpZWxkcztcbiAgcmV0dXJuIGpzb25Gb3JtO1xufTtcblxuZGVzY3JpYmUoJ0R5bmFtaWNGb3JtJywgKCkgPT4ge1xuICBsZXQgd3JhcHBlcjtcbiAgY29uc3Qgc2V0UmVxdWVzdCA9IGplc3QuZm4oKTtcbiAgY29uc3QgdGVzdEpzb24gPSBnZW5lcmF0ZVRlc3RGb3JtSnNvbigpO1xuICBjb25zb2xlLmxvZyh0ZXN0SnNvbik7XG4gIGNvbnN0IHJvdXRlID0gamVzdC5mbigpO1xuICBjb25zdCByZW5kZXJDb21wb25lbnQgPSAoKSA9PlxuICAgIHNoYWxsb3coXG4gICAgICA8RHluYW1pY0Zvcm1Db21wb25lbnRcbiAgICAgICAganNvbkZvcm09eygpID0+IHRlc3RKc29ufVxuICAgICAgICBzZXRSZXF1ZXN0PXtzZXRSZXF1ZXN0fVxuICAgICAgICBmb3JtPXtPYmplY3Qua2V5cyh0ZXN0SnNvbilbMF19XG4gICAgICAgIHJvdXRlPXsoKSA9PiB7XG4gICAgICAgICAgcm91dGUoKTtcbiAgICAgICAgfX1cbiAgICAgIC8+LFxuICAgICk7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgd3JhcHBlciA9IHJlbmRlckNvbXBvbmVudCgpO1xuICB9KTtcblxuICBpdCgnaXMgd3JhcHBlZCBpbiBhIFNlZ21lbnQnLCAoKSA9PiB7XG4gICAgZXhwZWN0KHdyYXBwZXIudHlwZSgpKS50b0VxdWFsKFNlZ21lbnQpO1xuICB9KTtcblxuICBpdCgnaXMgc3R5bGVkIGFzIGEgcGFkZGVkIFNlZ21lbnQnLCAoKSA9PiB7XG4gICAgZXhwZWN0KHdyYXBwZXIucHJvcHMoKS5wYWRkZWQpLnRvQmVUcnV0aHkoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2hlYWRlcicsICgpID0+IHtcbiAgICBsZXQgaGVhZGVyO1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBoZWFkZXIgPSB3cmFwcGVyLmNoaWxkQXQoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnaXMgYSBoZWFkZXInLCAoKSA9PiB7XG4gICAgICBleHBlY3QoaGVhZGVyLnR5cGUoKSkudG9FcXVhbChIZWFkZXIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2lzIGhhcyBhIGxhcmdlIHNpemUnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoaGVhZGVyLnByb3BzKCkuc2l6ZSkudG9FcXVhbCgnbGFyZ2UnKTtcbiAgICB9KTtcblxuICAgIGl0KCdpcyB0aGUgY29ycmVjdCB0ZXh0IGluIHRoZSBoZWFkZXInLCAoKSA9PiB7XG4gICAgICBleHBlY3QoaGVhZGVyLnRleHQoKSkudG8uZXF1YWwoT2JqZWN0LnZhbHVlcyh0ZXN0SnNvbilbMF0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZm9ybScsICgpID0+IHtcbiAgICBsZXQgZm9ybTtcbiAgICBsZXQgc2VnbWVudE9mRmllbGRzO1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBmb3JtID0gd3JhcHBlci5jaGlsZEF0KDEpO1xuICAgICAgc2VnbWVudE9mRmllbGRzID0gZm9ybS5jaGlsZEF0KDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ2lzIGEgZm9ybScsICgpID0+IHtcbiAgICAgIGV4cGVjdChmb3JtLnR5cGUoKSkudG9FcXVhbChGb3JtKTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdmb3JtIGRhdGEnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb3VudGVyID0gMDtcbiAgICAgIHRlc3RKc29uWzBdLmZvckVhY2goKGZpZWxkKSA9PiB7XG4gICAgICAgIGNvbnN0IGpzeEZpZWxkID0gc2VnbWVudE9mRmllbGRzLmNoaWxkQXQoY291bnRlcik7XG4gICAgICAgIGl0KGBmaWVsZCAke2NvdW50ZXJ9IGlzIGNvcnJlY3RgLCAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgbGFiZWwgPSBqc3hGaWVsZC5jaGlsZEF0KDApO1xuICAgICAgICAgIGlmIChmaWVsZC52YWxpZGF0aW9uKSB7XG4gICAgICAgICAgICBleHBlY3QobGFiZWwudGV4dCgpKS50by5lcXVhbChgKiR7ZmllbGQubmFtZX1gKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXhwZWN0KGxhYmVsLnRleHQoKSkudG8uZXF1YWwoZmllbGQubmFtZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGV4cGVjdChqc3hGaWVsZC5jaGlsZEF0KDEpLnByb3BzKCkubmFtZSA9PT0gZmllbGQubmFtZSk7XG4gICAgICAgICAgaWYgKGZpZWxkLnR5cGUgPT09ICdjaGVja2JveCcpIHtcbiAgICAgICAgICAgIGV4cGVjdChqc3hGaWVsZC5jaGlsZEF0KDEpLnR5cGUoKSkudG9FcXVhbChDaGVja2JveCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChmaWVsZC50eXBlID09PSAncmFkaW8nKSB7XG4gICAgICAgICAgICBleHBlY3QoanN4RmllbGQuY2hpbGRBdCgxKS50eXBlKCkpLnRvRXF1YWwoUmFkaW8pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZmllbGQudHlwZSA9PT0gJ3RleHRBcmVhJykge1xuICAgICAgICAgICAgZXhwZWN0KGpzeEZpZWxkLmNoaWxkQXQoMSkudHlwZSgpKS50b0VxdWFsKFRleHRBcmVhKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGZpZWxkLnR5cGUgPT09ICdkcm9wRG93bicpIHtcbiAgICAgICAgICAgIGV4cGVjdChqc3hGaWVsZC5jaGlsZEF0KDEpLnR5cGUoKSkudG9FcXVhbChEcm9wZG93bik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChmaWVsZC50eXBlID09PSAnaW5wdXQnKSB7XG4gICAgICAgICAgICBleHBlY3QoanN4RmllbGQuY2hpbGRBdCgxKS50eXBlKCkpLnRvRXF1YWwoSW5wdXQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1N1Ym1pdCBCdXR0b24nLCAoKSA9PiB7XG4gICAgbGV0IHN1Ym1pdFNlZ21lbnQ7XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIHN1Ym1pdFNlZ21lbnQgPSB3cmFwcGVyLmNoaWxkQXQoMSkuY2hpbGRBdCgxKTtcbiAgICB9KTtcblxuICAgIGl0KCdJdCBpcyBhIHNlZ21lbnQnLCAoKSA9PiB7XG4gICAgICBleHBlY3Qoc3VibWl0U2VnbWVudC50eXBlKCkpLnRvRXF1YWwoU2VnbWVudCk7XG4gICAgfSk7XG5cbiAgICBpdCgnVGhlcmUgaXMgYSBidXR0b24gaW4gdGhlIHNlZ21lbnQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBidXR0b24gPSBzdWJtaXRTZWdtZW50LmNoaWxkQXQoMCk7XG4gICAgICBleHBlY3QoYnV0dG9uLnR5cGUoKSkudG9FcXVhbChCdXR0b24pO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl19