e33a0ab93fdf183631c6628ac1d2dc99
'use strict';

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _semanticUiReact = require('semantic-ui-react');

var _enzyme = require('enzyme');

var _chance = require('chance');

var _DynamicForm = require('../../../src/components/helpers/DynamicForm');

var _DynamicForm2 = _interopRequireDefault(_DynamicForm);

var _InlineError = require('../../../src/components/helpers/InlineError');

var _InlineError2 = _interopRequireDefault(_InlineError);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var chance = new _chance.Chance();

var randomType = function randomType() {
  switch (chance.integer() % 4) {
    case 0:
      return 'textArea';
    case 1:
      return 'radio';
    case 2:
      return 'checkbox';
    case 3:
      return 'input';
    default:
      return 'textArea';
  }
};

var createRandomOptions = function createRandomOptions() {
  var options = [];
  var numberOfOptions = chance.integer() % 11 + 1;
  for (var counter = 0; counter < numberOfOptions; counter += 1) {
    options[counter] = chance.word();
  }
  return options;
};

var generateTestFormJson = function generateTestFormJson() {
  var name = chance.word();
  var jsonForm = {};
  var numberOfFields = chance.integer() % 11 + 1;
  var fields = [];
  for (var counter = 0; counter < numberOfFields; counter += 1) {
    var type = randomType();

    var field = {
      name: chance.word(),
      type: type,
      id: chance.word()
    };

    if (chance.integer() % 2 === 0) {
      field.validation = 'required';
    }
    if (type === 'radio') {
      field.options = createRandomOptions();
    }
    if (type === 'textArea' || type === 'input') {
      field.placeholder = chance.word();
    }

    fields[counter] = field;
  }
  jsonForm[name] = {};
  jsonForm[name].fields = fields;
  return jsonForm;
};

describe('DynamicForm', function () {
  var wrapper = void 0;
  var setRequest = jest.fn();
  var testJson = generateTestFormJson();
  var _route = jest.fn();
  var renderComponent = function renderComponent() {
    return (0, _enzyme.shallow)(_react2.default.createElement(_DynamicForm2.default, {
      jsonForm: function jsonForm() {
        return testJson;
      },
      setRequest: setRequest,
      form: Object.keys(testJson)[0],
      route: function route() {
        _route();
      }
    }));
  };

  beforeEach(function () {
    wrapper = renderComponent();
  });

  it('is wrapped in a Segment', function () {
    expect(wrapper.type()).toEqual(_semanticUiReact.Segment);
  });

  it('is styled as a padded Segment', function () {
    expect(wrapper.props().padded).toBeTruthy();
  });

  describe('header', function () {
    var header = void 0;

    beforeEach(function () {
      header = wrapper.childAt(0);
    });

    it('is a header', function () {
      expect(header.type()).toEqual(_semanticUiReact.Header);
    });

    it('is has a large size', function () {
      expect(header.props().size).toEqual('large');
    });

    it('is the correct text in the header', function () {
      expect(header.childAt(0).debug()).toEqual(Object.keys(testJson)[0]);
    });
  });

  describe('form', function () {
    it('is a form', function () {
      expect(wrapper.childAt(1).type()).toEqual(_semanticUiReact.Form);
    });

    describe('form data', function () {
      wrapper = renderComponent();
      testJson[Object.keys(testJson)[0]].fields.forEach(function (field) {
        if (field.validation) {
          var fail = chance.integer() % 2;
          var count = 0;
          var form = wrapper.childAt(1);
          var segmentOfFields = form.childAt(0);
          it('field ' + count + ' is correct', function () {
            var label = segmentOfFields.childAt(count).childAt(0);
            if (field.validation) {
              expect(label.text()).toEqual(' * ' + field.name);
            } else {
              expect(label.text()).toEqual(field.name);
            }
            expect(wrapper.childAt(1).childAt(0).childAt(count).childAt(1).props().name === field.name);
            if (field.type === 'checkbox') {
              expect(wrapper.childAt(1).childAt(0).childAt(count).childAt(1).type()).toEqual(_semanticUiReact.Checkbox);
            }
            if (field.type === 'radio') {
              expect(wrapper.childAt(1).childAt(0).childAt(count).childAt(1).type()).toEqual(_semanticUiReact.Radio);

              if (fail) {
                var state = { errors: {} };
                state.errors[field.id] = 'Radio Button Not Selected';
                wrapper.setState(state);
                wrapper.update();
                expect(wrapper.childAt(1).childAt(0).childAt(count).find(_InlineError2.default).props().text).toEqual('Radio Button Not Selected');
              }
            }
            if (field.type === 'textArea') {
              expect(wrapper.childAt(1).childAt(0).childAt(count).childAt(1).type()).toEqual(_semanticUiReact.TextArea);

              if (fail) {
                var _state = { errors: {} };
                _state.errors[field.id] = 'Empty Text Box';
                wrapper.setState(_state);
                wrapper.update();
                expect(wrapper.childAt(1).childAt(0).childAt(count).find(_InlineError2.default).props().text).toEqual('Empty Text Box');
              }
            }
            if (field.type === 'dropDown') {
              expect(wrapper.childAt(1).childAt(0).childAt(count).childAt(1).type()).toEqual(_semanticUiReact.Dropdown);

              if (fail) {
                var _state2 = { errors: {} };
                _state2.errors[field.id] = 'Nothing is Selected';
                wrapper.setState(_state2);
                wrapper.update();
                expect(wrapper.childAt(1).childAt(0).childAt(count).find(_InlineError2.default).props().text).toEqual('Nothing is Selected');
              }
            }

            if (field.type === 'input') {
              expect(wrapper.childAt(1).childAt(0).childAt(count).childAt(1).type()).toEqual(_semanticUiReact.Input);

              if (fail) {
                var _state3 = { errors: {} };
                _state3.errors[field.id] = 'Empty Input';
                wrapper.setState(_state3);
                wrapper.update();
                expect(wrapper.childAt(1).childAt(0).childAt(count).find(_InlineError2.default).props().text).toEqual('Empty Input');
              }
            }
            count += 1;
          });
        }
      });
    });
  });

  describe('Submit Button', function () {
    var submitSegment = void 0;

    beforeEach(function () {
      submitSegment = wrapper.childAt(1).childAt(1);
    });

    it('It is a segment', function () {
      expect(submitSegment.type()).toEqual(_semanticUiReact.Segment);
    });

    it('There is a button in the segment', function () {
      var button = submitSegment.childAt(0);
      expect(button.type()).toEqual(_semanticUiReact.Button);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkR5bmFtaWNGb3JtLnNwZWMuanMiXSwibmFtZXMiOlsiY2hhbmNlIiwiQ2hhbmNlIiwicmFuZG9tVHlwZSIsImludGVnZXIiLCJjcmVhdGVSYW5kb21PcHRpb25zIiwib3B0aW9ucyIsIm51bWJlck9mT3B0aW9ucyIsImNvdW50ZXIiLCJ3b3JkIiwiZ2VuZXJhdGVUZXN0Rm9ybUpzb24iLCJuYW1lIiwianNvbkZvcm0iLCJudW1iZXJPZkZpZWxkcyIsImZpZWxkcyIsInR5cGUiLCJmaWVsZCIsImlkIiwidmFsaWRhdGlvbiIsInBsYWNlaG9sZGVyIiwiZGVzY3JpYmUiLCJ3cmFwcGVyIiwic2V0UmVxdWVzdCIsImplc3QiLCJmbiIsInRlc3RKc29uIiwicm91dGUiLCJyZW5kZXJDb21wb25lbnQiLCJPYmplY3QiLCJrZXlzIiwiYmVmb3JlRWFjaCIsIml0IiwiZXhwZWN0IiwidG9FcXVhbCIsIlNlZ21lbnQiLCJwcm9wcyIsInBhZGRlZCIsInRvQmVUcnV0aHkiLCJoZWFkZXIiLCJjaGlsZEF0IiwiSGVhZGVyIiwic2l6ZSIsImRlYnVnIiwiRm9ybSIsImZvckVhY2giLCJmYWlsIiwiY291bnQiLCJmb3JtIiwic2VnbWVudE9mRmllbGRzIiwibGFiZWwiLCJ0ZXh0IiwiQ2hlY2tib3giLCJSYWRpbyIsInN0YXRlIiwiZXJyb3JzIiwic2V0U3RhdGUiLCJ1cGRhdGUiLCJmaW5kIiwiSW5saW5lRXJyb3JDb21wb25lbnQiLCJUZXh0QXJlYSIsIkRyb3Bkb3duIiwiSW5wdXQiLCJzdWJtaXRTZWdtZW50IiwiYnV0dG9uIiwiQnV0dG9uIl0sIm1hcHBpbmdzIjoiOztBQUFBOzs7O0FBQ0E7O0FBV0E7O0FBQ0E7O0FBQ0E7Ozs7QUFDQTs7Ozs7O0FBRUEsSUFBTUEsU0FBUyxJQUFJQyxjQUFKLEVBQWY7O0FBRUEsSUFBTUMsYUFBYSxTQUFiQSxVQUFhLEdBQU07QUFDdkIsVUFBUUYsT0FBT0csT0FBUCxLQUFtQixDQUEzQjtBQUNFLFNBQUssQ0FBTDtBQUNFLGFB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LFlBQU07QUFDOUIsUUFBSTBDLHNCQUFKOztBQUVBaEMsZUFBVyxZQUFNO0FBQ2ZnQyxzQkFBZ0J6QyxRQUFRa0IsT0FBUixDQUFnQixDQUFoQixFQUFtQkEsT0FBbkIsQ0FBMkIsQ0FBM0IsQ0FBaEI7QUFDRCxLQUZEOztBQUlBUixPQUFHLGlCQUFILEVBQXNCLFlBQU07QUFDMUJDLGFBQU84QixjQUFjL0MsSUFBZCxFQUFQLEVBQTZCa0IsT0FBN0IsQ0FBcUNDLHdCQUFyQztBQUNELEtBRkQ7O0FBSUFILE9BQUcsa0NBQUgsRUFBdUMsWUFBTTtBQUMzQyxVQUFNZ0MsU0FBU0QsY0FBY3ZCLE9BQWQsQ0FBc0IsQ0FBdEIsQ0FBZjtBQUNBUCxhQUFPK0IsT0FBT2hELElBQVAsRUFBUCxFQUFzQmtCLE9BQXRCLENBQThCK0IsdUJBQTlCO0FBQ0QsS0FIRDtBQUlELEdBZkQ7QUFnQkQsQ0FuTkQiLCJmaWxlIjoiRHluYW1pY0Zvcm0uc3BlYy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQge1xuICBCdXR0b24sXG4gIEZvcm0sXG4gIFNlZ21lbnQsXG4gIEhlYWRlcixcbiAgUmFkaW8sXG4gIENoZWNrYm94LFxuICBUZXh0QXJlYSxcbiAgRHJvcGRvd24sXG4gIElucHV0LFxufSBmcm9tICdzZW1hbnRpYy11aS1yZWFjdCc7XG5pbXBvcnQgeyBzaGFsbG93IH0gZnJvbSAnZW56eW1lJztcbmltcG9ydCB7IENoYW5jZSB9IGZyb20gJ2NoYW5jZSc7XG5pbXBvcnQgRHluYW1pY0Zvcm1Db21wb25lbnQgZnJvbSAnLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvaGVscGVycy9EeW5hbWljRm9ybSc7XG5pbXBvcnQgSW5saW5lRXJyb3JDb21wb25lbnQgZnJvbSAnLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvaGVscGVycy9JbmxpbmVFcnJvcic7XG5cbmNvbnN0IGNoYW5jZSA9IG5ldyBDaGFuY2UoKTtcblxuY29uc3QgcmFuZG9tVHlwZSA9ICgpID0+IHtcbiAgc3dpdGNoIChjaGFuY2UuaW50ZWdlcigpICUgNCkge1xuICAgIGNhc2UgMDpcbiAgICAgIHJldHVybiAndGV4dEFyZWEnO1xuICAgIGNhc2UgMTpcbiAgICAgIHJldHVybiAncmFkaW8nO1xuICAgIGNhc2UgMjpcbiAgICAgIHJldHVybiAnY2hlY2tib3gnO1xuICAgIGNhc2UgMzpcbiAgICAgIHJldHVybiAnaW5wdXQnO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gJ3RleHRBcmVhJztcbiAgfVxufTtcblxuY29uc3QgY3JlYXRlUmFuZG9tT3B0aW9ucyA9ICgpID0+IHtcbiAgY29uc3Qgb3B0aW9ucyA9IFtdO1xuICBjb25zdCBudW1iZXJPZk9wdGlvbnMgPSAoY2hhbmNlLmludGVnZXIoKSAlIDExKSArIDE7XG4gIGZvciAobGV0IGNvdW50ZXIgPSAwOyBjb3VudGVyIDwgbnVtYmVyT2ZPcHRpb25zOyBjb3VudGVyICs9IDEpIHtcbiAgICBvcHRpb25zW2NvdW50ZXJdID0gY2hhbmNlLndvcmQoKTtcbiAgfVxuICByZXR1cm4gb3B0aW9ucztcbn07XG5cbmNvbnN0IGdlbmVyYXRlVGVzdEZvcm1Kc29uID0gKCkgPT4ge1xuICBjb25zdCBuYW1lID0gY2hhbmNlLndvcmQoKTtcbiAgY29uc3QganNvbkZvcm0gPSB7fTtcbiAgY29uc3QgbnVtYmVyT2ZGaWVsZHMgPSAoY2hhbmNlLmludGVnZXIoKSAlIDExKSArIDE7XG4gIGNvbnN0IGZpZWxkcyA9IFtdO1xuICBmb3IgKGxldCBjb3VudGVyID0gMDsgY291bnRlciA8IG51bWJlck9mRmllbGRzOyBjb3VudGVyICs9IDEpIHtcbiAgICBjb25zdCB0eXBlID0gcmFuZG9tVHlwZSgpO1xuXG4gICAgY29uc3QgZmllbGQgPSB7XG4gICAgICBuYW1lOiBjaGFuY2Uud29yZCgpLFxuICAgICAgdHlwZSxcbiAgICAgIGlkOiBjaGFuY2Uud29yZCgpLFxuICAgIH07XG5cbiAgICBpZiAoY2hhbmNlLmludGVnZXIoKSAlIDIgPT09IDApIHtcbiAgICAgIGZpZWxkLnZhbGlkYXRpb24gPSAncmVxdWlyZWQnO1xuICAgIH1cbiAgICBpZiAodHlwZSA9PT0gJ3JhZGlvJykge1xuICAgICAgZmllbGQub3B0aW9ucyA9IGNyZWF0ZVJhbmRvbU9wdGlvbnMoKTtcbiAgICB9XG4gICAgaWYgKHR5cGUgPT09ICd0ZXh0QXJlYScgfHwgdHlwZSA9PT0gJ2lucHV0Jykge1xuICAgICAgZmllbGQucGxhY2Vob2xkZXIgPSBjaGFuY2Uud29yZCgpO1xuICAgIH1cblxuICAgIGZpZWxkc1tjb3VudGVyXSA9IGZpZWxkO1xuICB9XG4gIGpzb25Gb3JtW25hbWVdID0ge307XG4gIGpzb25Gb3JtW25hbWVdLmZpZWxkcyA9IGZpZWxkcztcbiAgcmV0dXJuIGpzb25Gb3JtO1xufTtcblxuZGVzY3JpYmUoJ0R5bmFtaWNGb3JtJywgKCkgPT4ge1xuICBsZXQgd3JhcHBlcjtcbiAgY29uc3Qgc2V0UmVxdWVzdCA9IGplc3QuZm4oKTtcbiAgY29uc3QgdGVzdEpzb24gPSBnZW5lcmF0ZVRlc3RGb3JtSnNvbigpO1xuICBjb25zdCByb3V0ZSA9IGplc3QuZm4oKTtcbiAgY29uc3QgcmVuZGVyQ29tcG9uZW50ID0gKCkgPT5cbiAgICBzaGFsbG93KFxuICAgICAgPER5bmFtaWNGb3JtQ29tcG9uZW50XG4gICAgICAgIGpzb25Gb3JtPXsoKSA9PiB0ZXN0SnNvbn1cbiAgICAgICAgc2V0UmVxdWVzdD17c2V0UmVxdWVzdH1cbiAgICAgICAgZm9ybT17T2JqZWN0LmtleXModGVzdEpzb24pWzBdfVxuICAgICAgICByb3V0ZT17KCkgPT4ge1xuICAgICAgICAgIHJvdXRlKCk7XG4gICAgICAgIH19XG4gICAgICAvPixcbiAgICApO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHdyYXBwZXIgPSByZW5kZXJDb21wb25lbnQoKTtcbiAgfSk7XG5cbiAgaXQoJ2lzIHdyYXBwZWQgaW4gYSBTZWdtZW50JywgKCkgPT4ge1xuICAgIGV4cGVjdCh3cmFwcGVyLnR5cGUoKSkudG9FcXVhbChTZWdtZW50KTtcbiAgfSk7XG5cbiAgaXQoJ2lzIHN0eWxlZCBhcyBhIHBhZGRlZCBTZWdtZW50JywgKCkgPT4ge1xuICAgIGV4cGVjdCh3cmFwcGVyLnByb3BzKCkucGFkZGVkKS50b0JlVHJ1dGh5KCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdoZWFkZXInLCAoKSA9PiB7XG4gICAgbGV0IGhlYWRlcjtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgaGVhZGVyID0gd3JhcHBlci5jaGlsZEF0KDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ2lzIGEgaGVhZGVyJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGhlYWRlci50eXBlKCkpLnRvRXF1YWwoSGVhZGVyKTtcbiAgICB9KTtcblxuICAgIGl0KCdpcyBoYXMgYSBsYXJnZSBzaXplJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGhlYWRlci5wcm9wcygpLnNpemUpLnRvRXF1YWwoJ2xhcmdlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnaXMgdGhlIGNvcnJlY3QgdGV4dCBpbiB0aGUgaGVhZGVyJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGhlYWRlci5jaGlsZEF0KDApLmRlYnVnKCkpLnRvRXF1YWwoT2JqZWN0LmtleXModGVzdEpzb24pWzBdKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2Zvcm0nLCAoKSA9PiB7XG4gICAgaXQoJ2lzIGEgZm9ybScsICgpID0+IHtcbiAgICAgIGV4cGVjdCh3cmFwcGVyLmNoaWxkQXQoMSkudHlwZSgpKS50b0VxdWFsKEZvcm0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2Zvcm0gZGF0YScsICgpID0+IHtcbiAgICAgIHdyYXBwZXIgPSByZW5kZXJDb21wb25lbnQoKTtcbiAgICAgIHRlc3RKc29uW09iamVjdC5rZXlzKHRlc3RKc29uKVswXV0uZmllbGRzLmZvckVhY2goKGZpZWxkKSA9PiB7XG4gICAgICAgIGlmIChmaWVsZC52YWxpZGF0aW9uKSB7XG4gICAgICAgICAgY29uc3QgZmFpbCA9IGNoYW5jZS5pbnRlZ2VyKCkgJSAyO1xuICAgICAgICAgIGxldCBjb3VudCA9IDA7XG4gICAgICAgICAgY29uc3QgZm9ybSA9IHdyYXBwZXIuY2hpbGRBdCgxKTtcbiAgICAgICAgICBjb25zdCBzZWdtZW50T2ZGaWVsZHMgPSBmb3JtLmNoaWxkQXQoMCk7XG4gICAgICAgICAgaXQoYGZpZWxkICR7Y291bnR9IGlzIGNvcnJlY3RgLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBsYWJlbCA9IHNlZ21lbnRPZkZpZWxkcy5jaGlsZEF0KGNvdW50KS5jaGlsZEF0KDApO1xuICAgICAgICAgICAgaWYgKGZpZWxkLnZhbGlkYXRpb24pIHtcbiAgICAgICAgICAgICAgZXhwZWN0KGxhYmVsLnRleHQoKSkudG9FcXVhbChgICogJHtmaWVsZC5uYW1lfWApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZXhwZWN0KGxhYmVsLnRleHQoKSkudG9FcXVhbChmaWVsZC5uYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV4cGVjdChcbiAgICAgICAgICAgICAgd3JhcHBlclxuICAgICAgICAgICAgICAgIC5jaGlsZEF0KDEpXG4gICAgICAgICAgICAgICAgLmNoaWxkQXQoMClcbiAgICAgICAgICAgICAgICAuY2hpbGRBdChjb3VudClcbiAgICAgICAgICAgICAgICAuY2hpbGRBdCgxKVxuICAgICAgICAgICAgICAgIC5wcm9wcygpLm5hbWUgPT09IGZpZWxkLm5hbWUsXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgaWYgKGZpZWxkLnR5cGUgPT09ICdjaGVja2JveCcpIHtcbiAgICAgICAgICAgICAgZXhwZWN0KFxuICAgICAgICAgICAgICAgIHdyYXBwZXJcbiAgICAgICAgICAgICAgICAgIC5jaGlsZEF0KDEpXG4gICAgICAgICAgICAgICAgICAuY2hpbGRBdCgwKVxuICAgICAgICAgICAgICAgICAgLmNoaWxkQXQoY291bnQpXG4gICAgICAgICAgICAgICAgICAuY2hpbGRBdCgxKVxuICAgICAgICAgICAgICAgICAgLnR5cGUoKSxcbiAgICAgICAgICAgICAgKS50b0VxdWFsKENoZWNrYm94KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmaWVsZC50eXBlID09PSAncmFkaW8nKSB7XG4gICAgICAgICAgICAgIGV4cGVjdChcbiAgICAgICAgICAgICAgICB3cmFwcGVyXG4gICAgICAgICAgICAgICAgICAuY2hpbGRBdCgxKVxuICAgICAgICAgICAgICAgICAgLmNoaWxkQXQoMClcbiAgICAgICAgICAgICAgICAgIC5jaGlsZEF0KGNvdW50KVxuICAgICAgICAgICAgICAgICAgLmNoaWxkQXQoMSlcbiAgICAgICAgICAgICAgICAgIC50eXBlKCksXG4gICAgICAgICAgICAgICkudG9FcXVhbChSYWRpbyk7XG5cbiAgICAgICAgICAgICAgaWYgKGZhaWwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdGF0ZSA9IHsgZXJyb3JzOiB7fSB9O1xuICAgICAgICAgICAgICAgIHN0YXRlLmVycm9yc1tmaWVsZC5pZF0gPSAnUmFkaW8gQnV0dG9uIE5vdCBTZWxlY3RlZCc7XG4gICAgICAgICAgICAgICAgd3JhcHBlci5zZXRTdGF0ZShzdGF0ZSk7XG4gICAgICAgICAgICAgICAgd3JhcHBlci51cGRhdGUoKTtcbiAgICAgICAgICAgICAgICBleHBlY3QoXG4gICAgICAgICAgICAgICAgICB3cmFwcGVyXG4gICAgICAgICAgICAgICAgICAgIC5jaGlsZEF0KDEpXG4gICAgICAgICAgICAgICAgICAgIC5jaGlsZEF0KDApXG4gICAgICAgICAgICAgICAgICAgIC5jaGlsZEF0KGNvdW50KVxuICAgICAgICAgICAgICAgICAgICAuZmluZChJbmxpbmVFcnJvckNvbXBvbmVudClcbiAgICAgICAgICAgICAgICAgICAgLnByb3BzKCkudGV4dCxcbiAgICAgICAgICAgICAgICApLnRvRXF1YWwoJ1JhZGlvIEJ1dHRvbiBOb3QgU2VsZWN0ZWQnKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZpZWxkLnR5cGUgPT09ICd0ZXh0QXJlYScpIHtcbiAgICAgICAgICAgICAgZXhwZWN0KFxuICAgICAgICAgICAgICAgIHdyYXBwZXJcbiAgICAgICAgICAgICAgICAgIC5jaGlsZEF0KDEpXG4gICAgICAgICAgICAgICAgICAuY2hpbGRBdCgwKVxuICAgICAgICAgICAgICAgICAgLmNoaWxkQXQoY291bnQpXG4gICAgICAgICAgICAgICAgICAuY2hpbGRBdCgxKVxuICAgICAgICAgICAgICAgICAgLnR5cGUoKSxcbiAgICAgICAgICAgICAgKS50b0VxdWFsKFRleHRBcmVhKTtcblxuICAgICAgICAgICAgICBpZiAoZmFpbCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXRlID0geyBlcnJvcnM6IHt9IH07XG4gICAgICAgICAgICAgICAgc3RhdGUuZXJyb3JzW2ZpZWxkLmlkXSA9ICdFbXB0eSBUZXh0IEJveCc7XG4gICAgICAgICAgICAgICAgd3JhcHBlci5zZXRTdGF0ZShzdGF0ZSk7XG4gICAgICAgICAgICAgICAgd3JhcHBlci51cGRhdGUoKTtcbiAgICAgICAgICAgICAgICBleHBlY3QoXG4gICAgICAgICAgICAgICAgICB3cmFwcGVyXG4gICAgICAgICAgICAgICAgICAgIC5jaGlsZEF0KDEpXG4gICAgICAgICAgICAgICAgICAgIC5jaGlsZEF0KDApXG4gICAgICAgICAgICAgICAgICAgIC5jaGlsZEF0KGNvdW50KVxuICAgICAgICAgICAgICAgICAgICAuZmluZChJbmxpbmVFcnJvckNvbXBvbmVudClcbiAgICAgICAgICAgICAgICAgICAgLnByb3BzKCkudGV4dCxcbiAgICAgICAgICAgICAgICApLnRvRXF1YWwoJ0VtcHR5IFRleHQgQm94Jyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmaWVsZC50eXBlID09PSAnZHJvcERvd24nKSB7XG4gICAgICAgICAgICAgIGV4cGVjdChcbiAgICAgICAgICAgICAgICB3cmFwcGVyXG4gICAgICAgICAgICAgICAgICAuY2hpbGRBdCgxKVxuICAgICAgICAgICAgICAgICAgLmNoaWxkQXQoMClcbiAgICAgICAgICAgICAgICAgIC5jaGlsZEF0KGNvdW50KVxuICAgICAgICAgICAgICAgICAgLmNoaWxkQXQoMSlcbiAgICAgICAgICAgICAgICAgIC50eXBlKCksXG4gICAgICAgICAgICAgICkudG9FcXVhbChEcm9wZG93bik7XG5cbiAgICAgICAgICAgICAgaWYgKGZhaWwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdGF0ZSA9IHsgZXJyb3JzOiB7fSB9O1xuICAgICAgICAgICAgICAgIHN0YXRlLmVycm9yc1tmaWVsZC5pZF0gPSAnTm90aGluZyBpcyBTZWxlY3RlZCc7XG4gICAgICAgICAgICAgICAgd3JhcHBlci5zZXRTdGF0ZShzdGF0ZSk7XG4gICAgICAgICAgICAgICAgd3JhcHBlci51cGRhdGUoKTtcbiAgICAgICAgICAgICAgICBleHBlY3QoXG4gICAgICAgICAgICAgICAgICB3cmFwcGVyXG4gICAgICAgICAgICAgICAgICAgIC5jaGlsZEF0KDEpXG4gICAgICAgICAgICAgICAgICAgIC5jaGlsZEF0KDApXG4gICAgICAgICAgICAgICAgICAgIC5jaGlsZEF0KGNvdW50KVxuICAgICAgICAgICAgICAgICAgICAuZmluZChJbmxpbmVFcnJvckNvbXBvbmVudClcbiAgICAgICAgICAgICAgICAgICAgLnByb3BzKCkudGV4dCxcbiAgICAgICAgICAgICAgICApLnRvRXF1YWwoJ05vdGhpbmcgaXMgU2VsZWN0ZWQnKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZmllbGQudHlwZSA9PT0gJ2lucHV0Jykge1xuICAgICAgICAgICAgICBleHBlY3QoXG4gICAgICAgICAgICAgICAgd3JhcHBlclxuICAgICAgICAgICAgICAgICAgLmNoaWxkQXQoMSlcbiAgICAgICAgICAgICAgICAgIC5jaGlsZEF0KDApXG4gICAgICAgICAgICAgICAgICAuY2hpbGRBdChjb3VudClcbiAgICAgICAgICAgICAgICAgIC5jaGlsZEF0KDEpXG4gICAgICAgICAgICAgICAgICAudHlwZSgpLFxuICAgICAgICAgICAgICApLnRvRXF1YWwoSW5wdXQpO1xuXG4gICAgICAgICAgICAgIGlmIChmYWlsKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhdGUgPSB7IGVycm9yczoge30gfTtcbiAgICAgICAgICAgICAgICBzdGF0ZS5lcnJvcnNbZmllbGQuaWRdID0gJ0VtcHR5IElucHV0JztcbiAgICAgICAgICAgICAgICB3cmFwcGVyLnNldFN0YXRlKHN0YXRlKTtcbiAgICAgICAgICAgICAgICB3cmFwcGVyLnVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgIGV4cGVjdChcbiAgICAgICAgICAgICAgICAgIHdyYXBwZXJcbiAgICAgICAgICAgICAgICAgICAgLmNoaWxkQXQoMSlcbiAgICAgICAgICAgICAgICAgICAgLmNoaWxkQXQoMClcbiAgICAgICAgICAgICAgICAgICAgLmNoaWxkQXQoY291bnQpXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKElubGluZUVycm9yQ29tcG9uZW50KVxuICAgICAgICAgICAgICAgICAgICAucHJvcHMoKS50ZXh0LFxuICAgICAgICAgICAgICAgICkudG9FcXVhbCgnRW1wdHkgSW5wdXQnKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY291bnQgKz0gMTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTdWJtaXQgQnV0dG9uJywgKCkgPT4ge1xuICAgIGxldCBzdWJtaXRTZWdtZW50O1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBzdWJtaXRTZWdtZW50ID0gd3JhcHBlci5jaGlsZEF0KDEpLmNoaWxkQXQoMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnSXQgaXMgYSBzZWdtZW50JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KHN1Ym1pdFNlZ21lbnQudHlwZSgpKS50b0VxdWFsKFNlZ21lbnQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ1RoZXJlIGlzIGEgYnV0dG9uIGluIHRoZSBzZWdtZW50JywgKCkgPT4ge1xuICAgICAgY29uc3QgYnV0dG9uID0gc3VibWl0U2VnbWVudC5jaGlsZEF0KDApO1xuICAgICAgZXhwZWN0KGJ1dHRvbi50eXBlKCkpLnRvRXF1YWwoQnV0dG9uKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdfQ==