9a996d1b2b280f9a53a4ade4b7652b10
'use strict';

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _semanticUiReact = require('semantic-ui-react');

var _enzyme = require('enzyme');

var _chance = require('chance');

var _DynamicForm = require('../../../src/components/helpers/DynamicForm');

var _DynamicForm2 = _interopRequireDefault(_DynamicForm);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var chance = new _chance.Chance();

var randomType = function randomType() {
  switch (chance.integer() % 4) {
    case 0:
      return 'textArea';
    case 1:
      return 'radio';
    case 2:
      return 'checkbox';
    case 3:
      return 'input';
    default:
      return 'textArea';
  }
};

var createRandomOptions = function createRandomOptions() {
  var options = [];
  var numberOfOptions = chance.integer() % 11 + 1;
  for (var counter = 0; counter < numberOfOptions; counter += 1) {
    options[counter] = chance.word();
  }
  return options;
};

var generateTestFormJson = function generateTestFormJson() {
  var name = chance.word();
  var jsonForm = {};
  var numberOfFields = chance.integer() % 11 + 1;
  var fields = [];
  for (var counter = 0; counter < numberOfFields; counter += 1) {
    var type = randomType();

    var field = {
      name: chance.word(),
      type: type,
      id: chance.word()
    };

    if (chance.integer() % 2 === 0) {
      field.validation = 'required';
    }
    if (type === 'radio') {
      field.options = createRandomOptions();
    }
    if (type === 'textArea' || type === 'input') {
      field.placeholder = chance.word();
    }

    fields[counter] = field;
  }
  jsonForm[name] = {};
  jsonForm[name].fields = fields;
  return jsonForm;
};

describe('DynamicForm', function () {
  var wrapper = void 0;
  var setRequest = jest.fn();
  var testJson = generateTestFormJson();
  var _route = jest.fn();
  var renderComponent = function renderComponent() {
    return (0, _enzyme.shallow)(_react2.default.createElement(_DynamicForm2.default, {
      jsonForm: function jsonForm() {
        return testJson;
      },
      setRequest: setRequest,
      form: Object.keys(testJson)[0],
      route: function route() {
        _route();
      }
    }));
  };

  beforeEach(function () {
    wrapper = renderComponent();
  });

  it('is wrapped in a Segment', function () {
    expect(wrapper.type()).toEqual(_semanticUiReact.Segment);
  });

  it('is styled as a padded Segment', function () {
    expect(wrapper.props().padded).toBeTruthy();
  });

  describe('header', function () {
    var header = void 0;

    beforeEach(function () {
      header = wrapper.childAt(0);
    });

    it('is a header', function () {
      expect(header.type()).toEqual(_semanticUiReact.Header);
    });

    it('is has a large size', function () {
      expect(header.props().size).toEqual('large');
    });

    it('is the correct text in the header', function () {
      console.log(header.childAt(0).debug());
      expect(header.childAt(0).text()).toEqual(Object.keys(testJson)[0]);
    });
  });

  describe('form', function () {
    var form = void 0;
    var segmentOfFields = void 0;

    beforeEach(function () {
      form = wrapper.childAt(1);
      segmentOfFields = form.childAt(0);
    });

    it('is a form', function () {
      expect(form.type()).toEqual(_semanticUiReact.Form);
    });

    describe('form data', function () {
      var counter = 0;
      testJson[0].forEach(function (field) {
        var jsxField = segmentOfFields.childAt(counter);
        it('field ' + counter + ' is correct', function () {
          var label = jsxField.childAt(0);
          if (field.validation) {
            expect(label.text()).toEqual('*' + field.name);
          } else {
            expect(label.text()).toEqual(field.name);
          }
          expect(jsxField.childAt(1).props().name === field.name);
          if (field.type === 'checkbox') {
            expect(jsxField.childAt(1).type()).toEqual(_semanticUiReact.Checkbox);
          }
          if (field.type === 'radio') {
            expect(jsxField.childAt(1).type()).toEqual(_semanticUiReact.Radio);
          }
          if (field.type === 'textArea') {
            expect(jsxField.childAt(1).type()).toEqual(_semanticUiReact.TextArea);
          }
          if (field.type === 'dropDown') {
            expect(jsxField.childAt(1).type()).toEqual(_semanticUiReact.Dropdown);
          }
          if (field.type === 'input') {
            expect(jsxField.childAt(1).type()).toEqual(_semanticUiReact.Input);
          }
        });
      });
    });
  });

  describe('Submit Button', function () {
    var submitSegment = void 0;

    beforeEach(function () {
      submitSegment = wrapper.childAt(1).childAt(1);
    });

    it('It is a segment', function () {
      expect(submitSegment.type()).toEqual(_semanticUiReact.Segment);
    });

    it('There is a button in the segment', function () {
      var button = submitSegment.childAt(0);
      expect(button.type()).toEqual(_semanticUiReact.Button);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkR5bmFtaWNGb3JtLnNwZWMuanMiXSwibmFtZXMiOlsiY2hhbmNlIiwiQ2hhbmNlIiwicmFuZG9tVHlwZSIsImludGVnZXIiLCJjcmVhdGVSYW5kb21PcHRpb25zIiwib3B0aW9ucyIsIm51bWJlck9mT3B0aW9ucyIsImNvdW50ZXIiLCJ3b3JkIiwiZ2VuZXJhdGVUZXN0Rm9ybUpzb24iLCJuYW1lIiwianNvbkZvcm0iLCJudW1iZXJPZkZpZWxkcyIsImZpZWxkcyIsInR5cGUiLCJmaWVsZCIsImlkIiwidmFsaWRhdGlvbiIsInBsYWNlaG9sZGVyIiwiZGVzY3JpYmUiLCJ3cmFwcGVyIiwic2V0UmVxdWVzdCIsImplc3QiLCJmbiIsInRlc3RKc29uIiwicm91dGUiLCJyZW5kZXJDb21wb25lbnQiLCJPYmplY3QiLCJrZXlzIiwiYmVmb3JlRWFjaCIsIml0IiwiZXhwZWN0IiwidG9FcXVhbCIsIlNlZ21lbnQiLCJwcm9wcyIsInBhZGRlZCIsInRvQmVUcnV0aHkiLCJoZWFkZXIiLCJjaGlsZEF0IiwiSGVhZGVyIiwic2l6ZSIsImNvbnNvbGUiLCJsb2ciLCJkZWJ1ZyIsInRleHQiLCJmb3JtIiwic2VnbWVudE9mRmllbGRzIiwiRm9ybSIsImZvckVhY2giLCJqc3hGaWVsZCIsImxhYmVsIiwiQ2hlY2tib3giLCJSYWRpbyIsIlRleHRBcmVhIiwiRHJvcGRvd24iLCJJbnB1dCIsInN1Ym1pdFNlZ21lbnQiLCJidXR0b24iLCJCdXR0b24iXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7O0FBRUEsSUFBTUEsU0FBUyxJQUFJQyxjQUFKLEVBQWY7O0FBRUEsSUFBTUMsYUFBYSxTQUFiQSxVQUFhLEdBQU07QUFDdkIsVUFBUUYsT0FBT0csT0FBUCxLQUFtQixDQUEzQjtBQUNFLFNBQUssQ0FBTDtBQUNFLGFBQU8sVUFBUDtBQUNGLFNBQUssQ0FBTDtBQUNFLGFBQU8sT0FBUDtBQUNGLFNBQUssQ0FBTDtBQUNFLGFBQU8s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QUEzQztBQUNEO0FBQ0YsU0F2QkQ7QUF3QkQsT0ExQkQ7QUEyQkQsS0E3QkQ7QUE4QkQsR0EzQ0Q7O0FBNkNBcEMsV0FBUyxlQUFULEVBQTBCLFlBQU07QUFDOUIsUUFBSXFDLHNCQUFKOztBQUVBM0IsZUFBVyxZQUFNO0FBQ2YyQixzQkFBZ0JwQyxRQUFRa0IsT0FBUixDQUFnQixDQUFoQixFQUFtQkEsT0FBbkIsQ0FBMkIsQ0FBM0IsQ0FBaEI7QUFDRCxLQUZEOztBQUlBUixPQUFHLGlCQUFILEVBQXNCLFlBQU07QUFDMUJDLGFBQU95QixjQUFjMUMsSUFBZCxFQUFQLEVBQTZCa0IsT0FBN0IsQ0FBcUNDLHdCQUFyQztBQUNELEtBRkQ7O0FBSUFILE9BQUcsa0NBQUgsRUFBdUMsWUFBTTtBQUMzQyxVQUFNMkIsU0FBU0QsY0FBY2xCLE9BQWQsQ0FBc0IsQ0FBdEIsQ0FBZjtBQUNBUCxhQUFPMEIsT0FBTzNDLElBQVAsRUFBUCxFQUFzQmtCLE9BQXRCLENBQThCMEIsdUJBQTlCO0FBQ0QsS0FIRDtBQUlELEdBZkQ7QUFnQkQsQ0EvR0QiLCJmaWxlIjoiRHluYW1pY0Zvcm0uc3BlYy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBCdXR0b24sIEZvcm0sIFNlZ21lbnQsIEhlYWRlciwgUmFkaW8sIENoZWNrYm94LCBUZXh0QXJlYSwgRHJvcGRvd24sIElucHV0IH0gZnJvbSAnc2VtYW50aWMtdWktcmVhY3QnO1xuaW1wb3J0IHsgc2hhbGxvdyB9IGZyb20gJ2VuenltZSc7XG5pbXBvcnQgeyBDaGFuY2UgfSBmcm9tICdjaGFuY2UnO1xuaW1wb3J0IER5bmFtaWNGb3JtQ29tcG9uZW50IGZyb20gJy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL2hlbHBlcnMvRHluYW1pY0Zvcm0nO1xuXG5jb25zdCBjaGFuY2UgPSBuZXcgQ2hhbmNlKCk7XG5cbmNvbnN0IHJhbmRvbVR5cGUgPSAoKSA9PiB7XG4gIHN3aXRjaCAoY2hhbmNlLmludGVnZXIoKSAlIDQpIHtcbiAgICBjYXNlIDA6XG4gICAgICByZXR1cm4gJ3RleHRBcmVhJztcbiAgICBjYXNlIDE6XG4gICAgICByZXR1cm4gJ3JhZGlvJztcbiAgICBjYXNlIDI6XG4gICAgICByZXR1cm4gJ2NoZWNrYm94JztcbiAgICBjYXNlIDM6XG4gICAgICByZXR1cm4gJ2lucHV0JztcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuICd0ZXh0QXJlYSc7XG4gIH1cbn07XG5cbmNvbnN0IGNyZWF0ZVJhbmRvbU9wdGlvbnMgPSAoKSA9PiB7XG4gIGNvbnN0IG9wdGlvbnMgPSBbXTtcbiAgY29uc3QgbnVtYmVyT2ZPcHRpb25zID0gKGNoYW5jZS5pbnRlZ2VyKCkgJSAxMSkgKyAxO1xuICBmb3IgKGxldCBjb3VudGVyID0gMDsgY291bnRlciA8IG51bWJlck9mT3B0aW9uczsgY291bnRlciArPSAxKSB7XG4gICAgb3B0aW9uc1tjb3VudGVyXSA9IGNoYW5jZS53b3JkKCk7XG4gIH1cbiAgcmV0dXJuIG9wdGlvbnM7XG59O1xuXG5jb25zdCBnZW5lcmF0ZVRlc3RGb3JtSnNvbiA9ICgpID0+IHtcbiAgY29uc3QgbmFtZSA9IGNoYW5jZS53b3JkKCk7XG4gIGNvbnN0IGpzb25Gb3JtID0ge307XG4gIGNvbnN0IG51bWJlck9mRmllbGRzID0gKGNoYW5jZS5pbnRlZ2VyKCkgJSAxMSkgKyAxO1xuICBjb25zdCBmaWVsZHMgPSBbXTtcbiAgZm9yIChsZXQgY291bnRlciA9IDA7IGNvdW50ZXIgPCBudW1iZXJPZkZpZWxkczsgY291bnRlciArPSAxKSB7XG4gICAgY29uc3QgdHlwZSA9IHJhbmRvbVR5cGUoKTtcblxuICAgIGNvbnN0IGZpZWxkID0ge1xuICAgICAgbmFtZTogY2hhbmNlLndvcmQoKSxcbiAgICAgIHR5cGUsXG4gICAgICBpZDogY2hhbmNlLndvcmQoKSxcbiAgICB9O1xuXG4gICAgaWYgKGNoYW5jZS5pbnRlZ2VyKCkgJSAyID09PSAwKSB7XG4gICAgICBmaWVsZC52YWxpZGF0aW9uID0gJ3JlcXVpcmVkJztcbiAgICB9XG4gICAgaWYgKHR5cGUgPT09ICdyYWRpbycpIHtcbiAgICAgIGZpZWxkLm9wdGlvbnMgPSBjcmVhdGVSYW5kb21PcHRpb25zKCk7XG4gICAgfVxuICAgIGlmICh0eXBlID09PSAndGV4dEFyZWEnIHx8IHR5cGUgPT09ICdpbnB1dCcpIHtcbiAgICAgIGZpZWxkLnBsYWNlaG9sZGVyID0gY2hhbmNlLndvcmQoKTtcbiAgICB9XG5cbiAgICBmaWVsZHNbY291bnRlcl0gPSBmaWVsZDtcbiAgfVxuICBqc29uRm9ybVtuYW1lXSA9IHt9O1xuICBqc29uRm9ybVtuYW1lXS5maWVsZHMgPSBmaWVsZHM7XG4gIHJldHVybiBqc29uRm9ybTtcbn07XG5cbmRlc2NyaWJlKCdEeW5hbWljRm9ybScsICgpID0+IHtcbiAgbGV0IHdyYXBwZXI7XG4gIGNvbnN0IHNldFJlcXVlc3QgPSBqZXN0LmZuKCk7XG4gIGNvbnN0IHRlc3RKc29uID0gZ2VuZXJhdGVUZXN0Rm9ybUpzb24oKTtcbiAgY29uc3Qgcm91dGUgPSBqZXN0LmZuKCk7XG4gIGNvbnN0IHJlbmRlckNvbXBvbmVudCA9ICgpID0+XG4gICAgc2hhbGxvdyhcbiAgICAgIDxEeW5hbWljRm9ybUNvbXBvbmVudFxuICAgICAgICBqc29uRm9ybT17KCkgPT4gdGVzdEpzb259XG4gICAgICAgIHNldFJlcXVlc3Q9e3NldFJlcXVlc3R9XG4gICAgICAgIGZvcm09e09iamVjdC5rZXlzKHRlc3RKc29uKVswXX1cbiAgICAgICAgcm91dGU9eygpID0+IHtcbiAgICAgICAgICByb3V0ZSgpO1xuICAgICAgICB9fVxuICAgICAgLz4sXG4gICAgKTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICB3cmFwcGVyID0gcmVuZGVyQ29tcG9uZW50KCk7XG4gIH0pO1xuXG4gIGl0KCdpcyB3cmFwcGVkIGluIGEgU2VnbWVudCcsICgpID0+IHtcbiAgICBleHBlY3Qod3JhcHBlci50eXBlKCkpLnRvRXF1YWwoU2VnbWVudCk7XG4gIH0pO1xuXG4gIGl0KCdpcyBzdHlsZWQgYXMgYSBwYWRkZWQgU2VnbWVudCcsICgpID0+IHtcbiAgICBleHBlY3Qod3JhcHBlci5wcm9wcygpLnBhZGRlZCkudG9CZVRydXRoeSgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnaGVhZGVyJywgKCkgPT4ge1xuICAgIGxldCBoZWFkZXI7XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIGhlYWRlciA9IHdyYXBwZXIuY2hpbGRBdCgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdpcyBhIGhlYWRlcicsICgpID0+IHtcbiAgICAgIGV4cGVjdChoZWFkZXIudHlwZSgpKS50b0VxdWFsKEhlYWRlcik7XG4gICAgfSk7XG5cbiAgICBpdCgnaXMgaGFzIGEgbGFyZ2Ugc2l6ZScsICgpID0+IHtcbiAgICAgIGV4cGVjdChoZWFkZXIucHJvcHMoKS5zaXplKS50b0VxdWFsKCdsYXJnZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2lzIHRoZSBjb3JyZWN0IHRleHQgaW4gdGhlIGhlYWRlcicsICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGhlYWRlci5jaGlsZEF0KDApLmRlYnVnKCkpO1xuICAgICAgZXhwZWN0KGhlYWRlci5jaGlsZEF0KDApLnRleHQoKSkudG9FcXVhbChPYmplY3Qua2V5cyh0ZXN0SnNvbilbMF0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZm9ybScsICgpID0+IHtcbiAgICBsZXQgZm9ybTtcbiAgICBsZXQgc2VnbWVudE9mRmllbGRzO1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBmb3JtID0gd3JhcHBlci5jaGlsZEF0KDEpO1xuICAgICAgc2VnbWVudE9mRmllbGRzID0gZm9ybS5jaGlsZEF0KDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ2lzIGEgZm9ybScsICgpID0+IHtcbiAgICAgIGV4cGVjdChmb3JtLnR5cGUoKSkudG9FcXVhbChGb3JtKTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdmb3JtIGRhdGEnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb3VudGVyID0gMDtcbiAgICAgIHRlc3RKc29uWzBdLmZvckVhY2goKGZpZWxkKSA9PiB7XG4gICAgICAgIGNvbnN0IGpzeEZpZWxkID0gc2VnbWVudE9mRmllbGRzLmNoaWxkQXQoY291bnRlcik7XG4gICAgICAgIGl0KGBmaWVsZCAke2NvdW50ZXJ9IGlzIGNvcnJlY3RgLCAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgbGFiZWwgPSBqc3hGaWVsZC5jaGlsZEF0KDApO1xuICAgICAgICAgIGlmIChmaWVsZC52YWxpZGF0aW9uKSB7XG4gICAgICAgICAgICBleHBlY3QobGFiZWwudGV4dCgpKS50b0VxdWFsKGAqJHtmaWVsZC5uYW1lfWApO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBleHBlY3QobGFiZWwudGV4dCgpKS50b0VxdWFsKGZpZWxkLm5hbWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBleHBlY3QoanN4RmllbGQuY2hpbGRBdCgxKS5wcm9wcygpLm5hbWUgPT09IGZpZWxkLm5hbWUpO1xuICAgICAgICAgIGlmIChmaWVsZC50eXBlID09PSAnY2hlY2tib3gnKSB7XG4gICAgICAgICAgICBleHBlY3QoanN4RmllbGQuY2hpbGRBdCgxKS50eXBlKCkpLnRvRXF1YWwoQ2hlY2tib3gpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZmllbGQudHlwZSA9PT0gJ3JhZGlvJykge1xuICAgICAgICAgICAgZXhwZWN0KGpzeEZpZWxkLmNoaWxkQXQoMSkudHlwZSgpKS50b0VxdWFsKFJhZGlvKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGZpZWxkLnR5cGUgPT09ICd0ZXh0QXJlYScpIHtcbiAgICAgICAgICAgIGV4cGVjdChqc3hGaWVsZC5jaGlsZEF0KDEpLnR5cGUoKSkudG9FcXVhbChUZXh0QXJlYSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChmaWVsZC50eXBlID09PSAnZHJvcERvd24nKSB7XG4gICAgICAgICAgICBleHBlY3QoanN4RmllbGQuY2hpbGRBdCgxKS50eXBlKCkpLnRvRXF1YWwoRHJvcGRvd24pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZmllbGQudHlwZSA9PT0gJ2lucHV0Jykge1xuICAgICAgICAgICAgZXhwZWN0KGpzeEZpZWxkLmNoaWxkQXQoMSkudHlwZSgpKS50b0VxdWFsKElucHV0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTdWJtaXQgQnV0dG9uJywgKCkgPT4ge1xuICAgIGxldCBzdWJtaXRTZWdtZW50O1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBzdWJtaXRTZWdtZW50ID0gd3JhcHBlci5jaGlsZEF0KDEpLmNoaWxkQXQoMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnSXQgaXMgYSBzZWdtZW50JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KHN1Ym1pdFNlZ21lbnQudHlwZSgpKS50b0VxdWFsKFNlZ21lbnQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ1RoZXJlIGlzIGEgYnV0dG9uIGluIHRoZSBzZWdtZW50JywgKCkgPT4ge1xuICAgICAgY29uc3QgYnV0dG9uID0gc3VibWl0U2VnbWVudC5jaGlsZEF0KDApO1xuICAgICAgZXhwZWN0KGJ1dHRvbi50eXBlKCkpLnRvRXF1YWwoQnV0dG9uKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdfQ==